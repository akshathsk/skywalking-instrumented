{"remainingRequest":"/home/sk117/final-project/copy/apache-skywalking-apm-9.2.0/skywalking-ui/node_modules/thread-loader/dist/cjs.js!/home/sk117/final-project/copy/apache-skywalking-apm-9.2.0/skywalking-ui/node_modules/babel-loader/lib/index.js!/home/sk117/final-project/copy/apache-skywalking-apm-9.2.0/skywalking-ui/node_modules/ts-loader/index.js??ref--15-3!/home/sk117/final-project/copy/apache-skywalking-apm-9.2.0/skywalking-ui/node_modules/cache-loader/dist/cjs.js??ref--1-0!/home/sk117/final-project/copy/apache-skywalking-apm-9.2.0/skywalking-ui/node_modules/vue-loader-v16/dist/index.js??ref--1-1!/home/sk117/final-project/copy/apache-skywalking-apm-9.2.0/skywalking-ui/src/views/dashboard/related/topology/components/Graph.vue?vue&type=script&lang=ts&setup=true","dependencies":[{"path":"/home/sk117/final-project/copy/apache-skywalking-apm-9.2.0/skywalking-ui/src/views/dashboard/related/topology/components/Graph.vue","mtime":1666468223588},{"path":"/home/sk117/final-project/copy/apache-skywalking-apm-9.2.0/skywalking-ui/babel.config.js","mtime":1666468223484},{"path":"/home/sk117/final-project/copy/apache-skywalking-apm-9.2.0/skywalking-ui/node_modules/unplugin/dist/webpack/loaders/transform.js","mtime":1666468252648},{"path":"/home/sk117/final-project/copy/apache-skywalking-apm-9.2.0/skywalking-ui/node_modules/unplugin/dist/webpack/loaders/transform.js","mtime":1666468252648},{"path":"/home/sk117/final-project/copy/apache-skywalking-apm-9.2.0/skywalking-ui/node_modules/unplugin/dist/webpack/loaders/transform.js","mtime":1666468252648},{"path":"/home/sk117/final-project/copy/apache-skywalking-apm-9.2.0/skywalking-ui/node_modules/unplugin/dist/webpack/loaders/transform.js","mtime":1666468252648},{"path":"/home/sk117/final-project/copy/apache-skywalking-apm-9.2.0/skywalking-ui/node_modules/cache-loader/dist/cjs.js","mtime":1666468229208},{"path":"/home/sk117/final-project/copy/apache-skywalking-apm-9.2.0/skywalking-ui/node_modules/thread-loader/dist/cjs.js","mtime":1666468239564},{"path":"/home/sk117/final-project/copy/apache-skywalking-apm-9.2.0/skywalking-ui/node_modules/babel-loader/lib/index.js","mtime":1666468229004},{"path":"/home/sk117/final-project/copy/apache-skywalking-apm-9.2.0/skywalking-ui/node_modules/ts-loader/index.js","mtime":1666468239640},{"path":"/home/sk117/final-project/copy/apache-skywalking-apm-9.2.0/skywalking-ui/node_modules/cache-loader/dist/cjs.js","mtime":1666468229208},{"path":"/home/sk117/final-project/copy/apache-skywalking-apm-9.2.0/skywalking-ui/node_modules/vue-loader-v16/dist/index.js","mtime":1666468249808}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiL2hvbWUvc2sxMTcvZmluYWwtcHJvamVjdC9jb3B5L2FwYWNoZS1za3l3YWxraW5nLWFwbS05LjIuMC9za3l3YWxraW5nLXVpL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyLmpzIjsKaW1wb3J0IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIGZyb20gIi9ob21lL3NrMTE3L2ZpbmFsLXByb2plY3QvY29weS9hcGFjaGUtc2t5d2Fsa2luZy1hcG0tOS4yLjAvc2t5d2Fsa2luZy11aS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlci5qcyI7CmltcG9ydCBfdG9Db25zdW1hYmxlQXJyYXkgZnJvbSAiL2hvbWUvc2sxMTcvZmluYWwtcHJvamVjdC9jb3B5L2FwYWNoZS1za3l3YWxraW5nLWFwbS05LjIuMC9za3l3YWxraW5nLXVpL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90b0NvbnN1bWFibGVBcnJheS5qcyI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICIvaG9tZS9zazExNy9maW5hbC1wcm9qZWN0L2NvcHkvYXBhY2hlLXNreXdhbGtpbmctYXBtLTkuMi4wL3NreXdhbGtpbmctdWkvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maW5kLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4uanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zeW1ib2wuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zeW1ib2wuZGVzY3JpcHRpb24uanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5udW1iZXIuY29uc3RydWN0b3IuanMiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCB7IGRlZmluZUNvbXBvbmVudCBhcyBfZGVmaW5lQ29tcG9uZW50IH0gZnJvbSAndnVlJzsKaW1wb3J0IHsgdW5yZWYgYXMgX3VucmVmLCBjcmVhdGVFbGVtZW50Vk5vZGUgYXMgX2NyZWF0ZUVsZW1lbnRWTm9kZSwgdG9EaXNwbGF5U3RyaW5nIGFzIF90b0Rpc3BsYXlTdHJpbmcsIGNyZWF0ZVZOb2RlIGFzIF9jcmVhdGVWTm9kZSwgb3BlbkJsb2NrIGFzIF9vcGVuQmxvY2ssIGNyZWF0ZUVsZW1lbnRCbG9jayBhcyBfY3JlYXRlRWxlbWVudEJsb2NrLCBjcmVhdGVDb21tZW50Vk5vZGUgYXMgX2NyZWF0ZUNvbW1lbnRWTm9kZSwgcmVzb2x2ZUNvbXBvbmVudCBhcyBfcmVzb2x2ZUNvbXBvbmVudCwgdlNob3cgYXMgX3ZTaG93LCB3aXRoRGlyZWN0aXZlcyBhcyBfd2l0aERpcmVjdGl2ZXMsIHJlbmRlckxpc3QgYXMgX3JlbmRlckxpc3QsIEZyYWdtZW50IGFzIF9GcmFnbWVudCwgbm9ybWFsaXplU3R5bGUgYXMgX25vcm1hbGl6ZVN0eWxlLCByZXNvbHZlRGlyZWN0aXZlIGFzIF9yZXNvbHZlRGlyZWN0aXZlIH0gZnJvbSAidnVlIjsKdmFyIF9ob2lzdGVkXzEgPSB7CiAgY2xhc3M6ICJsZWdlbmQiCn07CnZhciBfaG9pc3RlZF8yID0gWyJzcmMiXTsKdmFyIF9ob2lzdGVkXzMgPSBbInNyYyJdOwp2YXIgX2hvaXN0ZWRfNCA9IHsKICBrZXk6IDAsCiAgY2xhc3M6ICJzZXR0aW5nIgp9Owp2YXIgX2hvaXN0ZWRfNSA9IHsKICBjbGFzczogInRvb2wiCn07CnZhciBfaG9pc3RlZF82ID0gewogIGNsYXNzOiAibGFiZWwiCn07CnZhciBfaG9pc3RlZF83ID0gWyJvbkNsaWNrIl07CmltcG9ydCB7IHJlZiwgb25Nb3VudGVkLCBvbkJlZm9yZVVubW91bnQsIHJlYWN0aXZlLCB3YXRjaCwgY29tcHV0ZWQgfSBmcm9tICJ2dWUiOwppbXBvcnQgeyB1c2VJMThuIH0gZnJvbSAidnVlLWkxOG4iOwppbXBvcnQgKiBhcyBkMyBmcm9tICJkMyI7CmltcG9ydCBkM3RpcCBmcm9tICJkMy10aXAiOwppbXBvcnQgem9vbSBmcm9tICIuLi8uLi9jb21wb25lbnRzL3V0aWxzL3pvb20iOwppbXBvcnQgeyBzaW11bGF0aW9uSW5pdCwgc2ltdWxhdGlvblNraXAgfSBmcm9tICIuL3V0aWxzL3NpbXVsYXRpb24iOwppbXBvcnQgbm9kZUVsZW1lbnQgZnJvbSAiLi91dGlscy9ub2RlRWxlbWVudCI7CmltcG9ydCB7IGxpbmtFbGVtZW50LCBhbmNob3JFbGVtZW50LCBhcnJvd01hcmtlciB9IGZyb20gIi4vdXRpbHMvbGlua0VsZW1lbnQiOwppbXBvcnQgeyB1c2VTZWxlY3RvclN0b3JlIH0gZnJvbSAiQC9zdG9yZS9tb2R1bGVzL3NlbGVjdG9ycyI7CmltcG9ydCB7IHVzZVRvcG9sb2d5U3RvcmUgfSBmcm9tICJAL3N0b3JlL21vZHVsZXMvdG9wb2xvZ3kiOwppbXBvcnQgeyB1c2VEYXNoYm9hcmRTdG9yZSB9IGZyb20gIkAvc3RvcmUvbW9kdWxlcy9kYXNoYm9hcmQiOwppbXBvcnQgeyBFbnRpdHlUeXBlLCBEZXB0aExpc3QgfSBmcm9tICIuLi8uLi8uLi9kYXRhIjsKaW1wb3J0IHJvdXRlciBmcm9tICJAL3JvdXRlciI7CmltcG9ydCB7IEVsTWVzc2FnZSB9IGZyb20gImVsZW1lbnQtcGx1cyI7CmltcG9ydCBTZXR0aW5ncyBmcm9tICIuL1NldHRpbmdzLnZ1ZSI7CmltcG9ydCB7IHVzZUFwcFN0b3JlV2l0aE91dCB9IGZyb20gIkAvc3RvcmUvbW9kdWxlcy9hcHAiOwppbXBvcnQgZ2V0RGFzaGJvYXJkIGZyb20gIkAvaG9va3MvdXNlRGFzaGJvYXJkc1Nlc3Npb24iOwppbXBvcnQgeyBhZ2dyZWdhdGlvbiB9IGZyb20gIkAvaG9va3MvdXNlUHJvY2Vzc29yIjsKaW1wb3J0IGljb25zIGZyb20gIkAvYXNzZXRzL2ltZy9pY29ucyI7CmltcG9ydCB7IHVzZVF1ZXJ5VG9wb2xvZ3lNZXRyaWNzIH0gZnJvbSAiQC9ob29rcy91c2VQcm9jZXNzb3IiOwovKmdsb2JhbCBOdWxsYWJsZSwgZGVmaW5lUHJvcHMgKi8KCmV4cG9ydCBkZWZhdWx0IC8qI19fUFVSRV9fKi9fZGVmaW5lQ29tcG9uZW50KHsKICBwcm9wczogewogICAgY29uZmlnOiB7CiAgICAgIHR5cGU6IE9iamVjdCwKICAgICAgZGVmYXVsdDogZnVuY3Rpb24gX2RlZmF1bHQoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIGdyYXBoOiB7fQogICAgICAgIH07CiAgICAgIH0KICAgIH0KICB9LAogIHNldHVwOiBmdW5jdGlvbiBzZXR1cChfX3Byb3BzKSB7CiAgICB2YXIgcHJvcHMgPSBfX3Byb3BzOwoKICAgIHZhciBfdXNlSTE4biA9IHVzZUkxOG4oKSwKICAgICAgICB0ID0gX3VzZUkxOG4udDsKCiAgICB2YXIgc2VsZWN0b3JTdG9yZSA9IHVzZVNlbGVjdG9yU3RvcmUoKTsKICAgIHZhciB0b3BvbG9neVN0b3JlID0gdXNlVG9wb2xvZ3lTdG9yZSgpOwogICAgdmFyIGRhc2hib2FyZFN0b3JlID0gdXNlRGFzaGJvYXJkU3RvcmUoKTsKICAgIHZhciBhcHBTdG9yZSA9IHVzZUFwcFN0b3JlV2l0aE91dCgpOwogICAgdmFyIGhlaWdodCA9IHJlZigxMDApOwogICAgdmFyIHdpZHRoID0gcmVmKDEwMCk7CiAgICB2YXIgbG9hZGluZyA9IHJlZihmYWxzZSk7CiAgICB2YXIgc2ltdWxhdGlvbiA9IHJlZihudWxsKTsKICAgIHZhciBzdmcgPSByZWYobnVsbCk7CiAgICB2YXIgY2hhcnQgPSByZWYobnVsbCk7CiAgICB2YXIgdGlwID0gcmVmKG51bGwpOwogICAgdmFyIGdyYXBoID0gcmVmKG51bGwpOwogICAgdmFyIG5vZGUgPSByZWYobnVsbCk7CiAgICB2YXIgbGluayA9IHJlZihudWxsKTsKICAgIHZhciBhbmNob3IgPSByZWYobnVsbCk7CiAgICB2YXIgYXJyb3cgPSByZWYobnVsbCk7CiAgICB2YXIgc2hvd1NldHRpbmcgPSByZWYoZmFsc2UpOwogICAgdmFyIHNldHRpbmdzID0gcmVmKHByb3BzLmNvbmZpZyk7CiAgICB2YXIgb3BlcmF0aW9uc1BvcyA9IHJlYWN0aXZlKHsKICAgICAgeDogTmFOLAogICAgICB5OiBOYU4KICAgIH0pOwogICAgdmFyIGl0ZW1zID0gcmVmKFtdKTsKICAgIHZhciBncmFwaENvbmZpZyA9IGNvbXB1dGVkKGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHByb3BzLmNvbmZpZy5ncmFwaCB8fCB7fTsKICAgIH0pOwogICAgdmFyIGRlcHRoID0gcmVmKGdyYXBoQ29uZmlnLnZhbHVlLmRlcHRoIHx8IDIpOwogICAgb25Nb3VudGVkKCAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICB2YXIgX2RvY3VtZW50JHF1ZXJ5U2VsZWN0OwoKICAgICAgdmFyIGpzb24sIHJlc3AsIGRvbTsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGxvYWRpbmcudmFsdWUgPSB0cnVlOwogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzOwogICAgICAgICAgICAgIHJldHVybiBzZWxlY3RvclN0b3JlLmZldGNoU2VydmljZXMoZGFzaGJvYXJkU3RvcmUubGF5ZXJJZCk7CgogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAganNvbiA9IF9jb250ZXh0LnNlbnQ7CgogICAgICAgICAgICAgIGlmICghanNvbi5lcnJvcnMpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA3OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoanNvbi5lcnJvcnMpOwogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA5OwogICAgICAgICAgICAgIHJldHVybiBnZXRUb3BvbG9neSgpOwoKICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgIHJlc3AgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgIGxvYWRpbmcudmFsdWUgPSBmYWxzZTsKCiAgICAgICAgICAgICAgaWYgKHJlc3AgJiYgcmVzcC5lcnJvcnMpIHsKICAgICAgICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcihyZXNwLmVycm9ycyk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB0b3BvbG9neVN0b3JlLmdldExpbmtDbGllbnRNZXRyaWNzKHNldHRpbmdzLnZhbHVlLmxpbmtDbGllbnRNZXRyaWNzIHx8IFtdKTsKICAgICAgICAgICAgICB0b3BvbG9neVN0b3JlLmdldExpbmtTZXJ2ZXJNZXRyaWNzKHNldHRpbmdzLnZhbHVlLmxpbmtTZXJ2ZXJNZXRyaWNzIHx8IFtdKTsKICAgICAgICAgICAgICB0b3BvbG9neVN0b3JlLnF1ZXJ5Tm9kZU1ldHJpY3Moc2V0dGluZ3MudmFsdWUubm9kZU1ldHJpY3MgfHwgW10pOwogICAgICAgICAgICAgIGRvbSA9ICgoX2RvY3VtZW50JHF1ZXJ5U2VsZWN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLnRvcG9sb2d5IikpID09PSBudWxsIHx8IF9kb2N1bWVudCRxdWVyeVNlbGVjdCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2RvY3VtZW50JHF1ZXJ5U2VsZWN0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpKSB8fCB7CiAgICAgICAgICAgICAgICBoZWlnaHQ6IDQwLAogICAgICAgICAgICAgICAgd2lkdGg6IDAKICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgIGhlaWdodC52YWx1ZSA9IGRvbS5oZWlnaHQgLSA0MDsKICAgICAgICAgICAgICB3aWR0aC52YWx1ZSA9IGRvbS53aWR0aDsKICAgICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigicmVzaXplIiwgcmVzaXplKTsKICAgICAgICAgICAgICBzdmcudmFsdWUgPSBkMy5zZWxlY3QoY2hhcnQudmFsdWUpLmFwcGVuZCgic3ZnIikuYXR0cigiY2xhc3MiLCAidG9wby1zdmciKTsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjI7CiAgICAgICAgICAgICAgcmV0dXJuIGluaXRMZWdlbmRNZXRyaWNzKCk7CgogICAgICAgICAgICBjYXNlIDIyOgogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyNDsKICAgICAgICAgICAgICByZXR1cm4gaW5pdCgpOwoKICAgICAgICAgICAgY2FzZSAyNDoKICAgICAgICAgICAgICB1cGRhdGUoKTsKICAgICAgICAgICAgICBzZXROb2RlVG9vbHMoc2V0dGluZ3MudmFsdWUubm9kZURhc2hib2FyZCk7CgogICAgICAgICAgICBjYXNlIDI2OgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlKTsKICAgIH0pKSk7CgogICAgZnVuY3Rpb24gaW5pdCgpIHsKICAgICAgcmV0dXJuIF9pbml0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9CgogICAgZnVuY3Rpb24gX2luaXQoKSB7CiAgICAgIF9pbml0ID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgdGlwLnZhbHVlID0gZDN0aXAoKS5hdHRyKCJjbGFzcyIsICJkMy10aXAiKS5vZmZzZXQoWy04LCAwXSk7CiAgICAgICAgICAgICAgICBncmFwaC52YWx1ZSA9IHN2Zy52YWx1ZS5hcHBlbmQoImciKS5hdHRyKCJjbGFzcyIsICJ0b3BvLXN2Zy1ncmFwaCIpLmF0dHIoInRyYW5zZm9ybSIsICJ0cmFuc2xhdGUoLTEwMCwgLTEwMCkiKTsKICAgICAgICAgICAgICAgIGdyYXBoLnZhbHVlLmNhbGwodGlwLnZhbHVlKTsKICAgICAgICAgICAgICAgIHNpbXVsYXRpb24udmFsdWUgPSBzaW11bGF0aW9uSW5pdChkMywgdG9wb2xvZ3lTdG9yZS5ub2RlcywgdG9wb2xvZ3lTdG9yZS5jYWxscywgdGlja2VkKTsKICAgICAgICAgICAgICAgIG5vZGUudmFsdWUgPSBncmFwaC52YWx1ZS5hcHBlbmQoImciKS5zZWxlY3RBbGwoIi50b3BvLW5vZGUiKTsKICAgICAgICAgICAgICAgIGxpbmsudmFsdWUgPSBncmFwaC52YWx1ZS5hcHBlbmQoImciKS5zZWxlY3RBbGwoIi50b3BvLWxpbmUiKTsKICAgICAgICAgICAgICAgIGFuY2hvci52YWx1ZSA9IGdyYXBoLnZhbHVlLmFwcGVuZCgiZyIpLnNlbGVjdEFsbCgiLnRvcG8tbGluZS1hbmNob3IiKTsKICAgICAgICAgICAgICAgIGFycm93LnZhbHVlID0gZ3JhcGgudmFsdWUuYXBwZW5kKCJnIikuc2VsZWN0QWxsKCIudG9wby1saW5lLWFycm93Iik7CiAgICAgICAgICAgICAgICBzdmcudmFsdWUuY2FsbCh6b29tKGQzLCBncmFwaC52YWx1ZSwgWy0xMDAsIC0xMDBdKSk7CiAgICAgICAgICAgICAgICBzdmcudmFsdWUub24oImNsaWNrIiwgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgICAgICB0b3BvbG9neVN0b3JlLnNldE5vZGUobnVsbCk7CiAgICAgICAgICAgICAgICAgIHRvcG9sb2d5U3RvcmUuc2V0TGluayhudWxsKTsKICAgICAgICAgICAgICAgICAgZGFzaGJvYXJkU3RvcmUuc2VsZWN0V2lkZ2V0KHByb3BzLmNvbmZpZyk7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMik7CiAgICAgIH0pKTsKICAgICAgcmV0dXJuIF9pbml0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9CgogICAgZnVuY3Rpb24gaW5pdExlZ2VuZE1ldHJpY3MoKSB7CiAgICAgIHJldHVybiBfaW5pdExlZ2VuZE1ldHJpY3MuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH0KCiAgICBmdW5jdGlvbiBfaW5pdExlZ2VuZE1ldHJpY3MoKSB7CiAgICAgIF9pbml0TGVnZW5kTWV0cmljcyA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoKSB7CiAgICAgICAgdmFyIGlkcywgbmFtZXMsIHBhcmFtLCByZXM7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGlkcyA9IHRvcG9sb2d5U3RvcmUubm9kZXMubWFwKGZ1bmN0aW9uIChkKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBkLmlkOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBuYW1lcyA9IHByb3BzLmNvbmZpZy5sZWdlbmQubWFwKGZ1bmN0aW9uIChkKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBkLm5hbWU7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICBpZiAoIShuYW1lcy5sZW5ndGggJiYgaWRzLmxlbmd0aCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAxMDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA1OwogICAgICAgICAgICAgICAgcmV0dXJuIHVzZVF1ZXJ5VG9wb2xvZ3lNZXRyaWNzKG5hbWVzLCBpZHMpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBwYXJhbSA9IF9jb250ZXh0My5zZW50OwogICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA4OwogICAgICAgICAgICAgICAgcmV0dXJuIHRvcG9sb2d5U3RvcmUuZ2V0TGVnZW5kTWV0cmljcyhwYXJhbSk7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgIHJlcyA9IF9jb250ZXh0My5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXMuZXJyb3JzKSB7CiAgICAgICAgICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcihyZXMuZXJyb3JzKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMyk7CiAgICAgIH0pKTsKICAgICAgcmV0dXJuIF9pbml0TGVnZW5kTWV0cmljcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgfQoKICAgIGZ1bmN0aW9uIHRpY2tlZCgpIHsKICAgICAgbGluay52YWx1ZS5hdHRyKCJkIiwgZnVuY3Rpb24gKGQpIHsKICAgICAgICByZXR1cm4gIk0iLmNvbmNhdChkLnNvdXJjZS54LCAiICIpLmNvbmNhdChkLnNvdXJjZS55LCAiIFEgIikuY29uY2F0KChkLnNvdXJjZS54ICsgZC50YXJnZXQueCkgLyAyLCAiICIpLmNvbmNhdCgoZC50YXJnZXQueSArIGQuc291cmNlLnkpIC8gMiAtIGQubG9vcEZhY3RvciAqIDkwLCAiICIpLmNvbmNhdChkLnRhcmdldC54LCAiICIpLmNvbmNhdChkLnRhcmdldC55KTsKICAgICAgfSk7CiAgICAgIGFuY2hvci52YWx1ZS5hdHRyKCJ0cmFuc2Zvcm0iLCBmdW5jdGlvbiAoZCkgewogICAgICAgIHJldHVybiAidHJhbnNsYXRlKCIuY29uY2F0KChkLnNvdXJjZS54ICsgZC50YXJnZXQueCkgLyAyLCAiLCAiKS5jb25jYXQoKGQudGFyZ2V0LnkgKyBkLnNvdXJjZS55KSAvIDIgLSBkLmxvb3BGYWN0b3IgKiA0NSwgIikiKTsKICAgICAgfSk7CiAgICAgIG5vZGUudmFsdWUuYXR0cigidHJhbnNmb3JtIiwgZnVuY3Rpb24gKGQpIHsKICAgICAgICByZXR1cm4gInRyYW5zbGF0ZSgiLmNvbmNhdChkLnggLSAyMiwgIiwiKS5jb25jYXQoZC55IC0gMjIsICIpIik7CiAgICAgIH0pOwogICAgfQoKICAgIGZ1bmN0aW9uIGRyYWdzdGFydChkKSB7CiAgICAgIG5vZGUudmFsdWUuX2dyb3Vwc1swXS5mb3JFYWNoKGZ1bmN0aW9uIChnKSB7CiAgICAgICAgZy5fX2RhdGFfXy5meCA9IGcuX19kYXRhX18ueDsKICAgICAgICBnLl9fZGF0YV9fLmZ5ID0gZy5fX2RhdGFfXy55OwogICAgICB9KTsKCiAgICAgIGlmICghZC5hY3RpdmUpIHsKICAgICAgICBzaW11bGF0aW9uLnZhbHVlLmFscGhhVGFyZ2V0KDAuMSkucmVzdGFydCgpOwogICAgICB9CgogICAgICBkLnN1YmplY3QuZnggPSBkLnN1YmplY3QueDsKICAgICAgZC5zdWJqZWN0LmZ5ID0gZC5zdWJqZWN0Lnk7CiAgICAgIGQuc291cmNlRXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICB9CgogICAgZnVuY3Rpb24gZHJhZ2dlZChkKSB7CiAgICAgIGQuc3ViamVjdC5meCA9IGQueDsKICAgICAgZC5zdWJqZWN0LmZ5ID0gZC55OwogICAgfQoKICAgIGZ1bmN0aW9uIGRyYWdlbmRlZChkKSB7CiAgICAgIGlmICghZC5hY3RpdmUpIHsKICAgICAgICBzaW11bGF0aW9uLnZhbHVlLmFscGhhVGFyZ2V0KDApOwogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gaGFuZGxlTm9kZUNsaWNrKGQpIHsKICAgICAgdG9wb2xvZ3lTdG9yZS5zZXROb2RlKGQpOwogICAgICB0b3BvbG9neVN0b3JlLnNldExpbmsobnVsbCk7CiAgICAgIG9wZXJhdGlvbnNQb3MueCA9IGQueCAtIDEwMDsKICAgICAgb3BlcmF0aW9uc1Bvcy55ID0gZC55IC0gNzA7CgogICAgICBpZiAoZC5sYXllciA9PT0gU3RyaW5nKGRhc2hib2FyZFN0b3JlLmxheWVySWQpKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpdGVtcy52YWx1ZSA9IFt7CiAgICAgICAgaWQ6ICJpbnNwZWN0IiwKICAgICAgICB0aXRsZTogIkluc3BlY3QiLAogICAgICAgIGZ1bmM6IGhhbmRsZUluc3BlY3QKICAgICAgfSwgewogICAgICAgIGlkOiAiYWxhcm0iLAogICAgICAgIHRpdGxlOiAiQWxhcm0iLAogICAgICAgIGZ1bmM6IGhhbmRsZUdvQWxhcm0KICAgICAgfV07CiAgICB9CgogICAgZnVuY3Rpb24gaGFuZGxlTGlua0NsaWNrKGV2ZW50LCBkKSB7CiAgICAgIGlmIChkLnNvdXJjZS5sYXllciAhPT0gZGFzaGJvYXJkU3RvcmUubGF5ZXJJZCB8fCBkLnRhcmdldC5sYXllciAhPT0gZGFzaGJvYXJkU3RvcmUubGF5ZXJJZCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgIHRvcG9sb2d5U3RvcmUuc2V0Tm9kZShudWxsKTsKICAgICAgdG9wb2xvZ3lTdG9yZS5zZXRMaW5rKGQpOwoKICAgICAgaWYgKCFzZXR0aW5ncy52YWx1ZS5saW5rRGFzaGJvYXJkKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgb3JpZ2luID0gZGFzaGJvYXJkU3RvcmUuZW50aXR5OwogICAgICB2YXIgZSA9IGRhc2hib2FyZFN0b3JlLmVudGl0eSA9PT0gRW50aXR5VHlwZVsxXS52YWx1ZSA/IEVudGl0eVR5cGVbMF0udmFsdWUgOiBkYXNoYm9hcmRTdG9yZS5lbnRpdHk7CgogICAgICB2YXIgX2dldERhc2hib2FyZCA9IGdldERhc2hib2FyZCh7CiAgICAgICAgbmFtZTogc2V0dGluZ3MudmFsdWUubGlua0Rhc2hib2FyZCwKICAgICAgICBsYXllcjogZGFzaGJvYXJkU3RvcmUubGF5ZXJJZCwKICAgICAgICBlbnRpdHk6ICIiLmNvbmNhdChlLCAiUmVsYXRpb24iKQogICAgICB9KSwKICAgICAgICAgIGRhc2hib2FyZCA9IF9nZXREYXNoYm9hcmQuZGFzaGJvYXJkOwoKICAgICAgaWYgKCFkYXNoYm9hcmQpIHsKICAgICAgICBFbE1lc3NhZ2UuZXJyb3IoIlRoZSBkYXNoYm9hcmQgbmFtZWQgIi5jb25jYXQoc2V0dGluZ3MudmFsdWUubGlua0Rhc2hib2FyZCwgIiBkb2Vzbid0IGV4aXN0IikpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgZGFzaGJvYXJkU3RvcmUuc2V0RW50aXR5KGRhc2hib2FyZC5lbnRpdHkpOwogICAgICB2YXIgcGF0aCA9ICIvZGFzaGJvYXJkL3JlbGF0ZWQvIi5jb25jYXQoZGFzaGJvYXJkLmxheWVyLCAiLyIpLmNvbmNhdChlLCAiUmVsYXRpb24vIikuY29uY2F0KGQuc291cmNlLmlkLCAiLyIpLmNvbmNhdChkLnRhcmdldC5pZCwgIi8iKS5jb25jYXQoZGFzaGJvYXJkLm5hbWUpOwogICAgICB2YXIgcm91dGVVcmwgPSByb3V0ZXIucmVzb2x2ZSh7CiAgICAgICAgcGF0aDogcGF0aAogICAgICB9KTsKICAgICAgd2luZG93Lm9wZW4ocm91dGVVcmwuaHJlZiwgIl9ibGFuayIpOwogICAgICBkYXNoYm9hcmRTdG9yZS5zZXRFbnRpdHkob3JpZ2luKTsKICAgIH0KCiAgICBmdW5jdGlvbiB1cGRhdGUoKSB7CiAgICAgIC8vIG5vZGUgZWxlbWVudAogICAgICBpZiAoIW5vZGUudmFsdWUgfHwgIWxpbmsudmFsdWUpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIG5vZGUudmFsdWUgPSBub2RlLnZhbHVlLmRhdGEodG9wb2xvZ3lTdG9yZS5ub2RlcywgZnVuY3Rpb24gKGQpIHsKICAgICAgICByZXR1cm4gZC5pZDsKICAgICAgfSk7CiAgICAgIG5vZGUudmFsdWUuZXhpdCgpLnJlbW92ZSgpOwogICAgICBub2RlLnZhbHVlID0gbm9kZUVsZW1lbnQoZDMsIG5vZGUudmFsdWUuZW50ZXIoKSwgewogICAgICAgIGRyYWdzdGFydDogZHJhZ3N0YXJ0LAogICAgICAgIGRyYWdnZWQ6IGRyYWdnZWQsCiAgICAgICAgZHJhZ2VuZGVkOiBkcmFnZW5kZWQsCiAgICAgICAgaGFuZGxlTm9kZUNsaWNrOiBoYW5kbGVOb2RlQ2xpY2ssCiAgICAgICAgdGlwSHRtbDogZnVuY3Rpb24gdGlwSHRtbChkYXRhKSB7CiAgICAgICAgICB2YXIgbm9kZU1ldHJpY3MgPSBzZXR0aW5ncy52YWx1ZS5ub2RlTWV0cmljcyB8fCBbXTsKICAgICAgICAgIHZhciBub2RlTWV0cmljQ29uZmlnID0gc2V0dGluZ3MudmFsdWUubm9kZU1ldHJpY0NvbmZpZyB8fCBbXTsKICAgICAgICAgIHZhciBodG1sID0gbm9kZU1ldHJpY3MubWFwKGZ1bmN0aW9uIChtLCBpbmRleCkgewogICAgICAgICAgICB2YXIgbWV0cmljID0gdG9wb2xvZ3lTdG9yZS5ub2RlTWV0cmljVmFsdWVbbV0udmFsdWVzLmZpbmQoZnVuY3Rpb24gKHZhbCkgewogICAgICAgICAgICAgIHJldHVybiB2YWwuaWQgPT09IGRhdGEuaWQ7CiAgICAgICAgICAgIH0pIHx8IHt9OwogICAgICAgICAgICB2YXIgb3B0ID0gbm9kZU1ldHJpY0NvbmZpZ1tpbmRleF0gfHwge307CiAgICAgICAgICAgIHZhciB2ID0gYWdncmVnYXRpb24obWV0cmljLnZhbHVlLCBvcHQpOwogICAgICAgICAgICByZXR1cm4gIiA8ZGl2IGNsYXNzPVwibWItNVwiPjxzcGFuIGNsYXNzPVwiZ3JleVwiPiIuY29uY2F0KG9wdC5sYWJlbCB8fCBtLCAiOiA8L3NwYW4+IikuY29uY2F0KHYsICIgIikuY29uY2F0KG9wdC51bml0IHx8ICIiLCAiPC9kaXY+Iik7CiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybiBbIiA8ZGl2IGNsYXNzPVwibWItNVwiPjxzcGFuIGNsYXNzPVwiZ3JleVwiPm5hbWU6IDwvc3Bhbj4iLmNvbmNhdChkYXRhLm5hbWUsICI8L2Rpdj4iKV0uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShodG1sKSkuam9pbigiICIpOwogICAgICAgIH0KICAgICAgfSwgdGlwLnZhbHVlLCBzZXR0aW5ncy52YWx1ZS5sZWdlbmQpLm1lcmdlKG5vZGUudmFsdWUpOyAvLyBsaW5lIGVsZW1lbnQKCiAgICAgIGxpbmsudmFsdWUgPSBsaW5rLnZhbHVlLmRhdGEodG9wb2xvZ3lTdG9yZS5jYWxscywgZnVuY3Rpb24gKGQpIHsKICAgICAgICByZXR1cm4gZC5pZDsKICAgICAgfSk7CiAgICAgIGxpbmsudmFsdWUuZXhpdCgpLnJlbW92ZSgpOwogICAgICBsaW5rLnZhbHVlID0gbGlua0VsZW1lbnQobGluay52YWx1ZS5lbnRlcigpKS5tZXJnZShsaW5rLnZhbHVlKTsgLy8gYW5jaG9yRWxlbWVudAoKICAgICAgYW5jaG9yLnZhbHVlID0gYW5jaG9yLnZhbHVlLmRhdGEodG9wb2xvZ3lTdG9yZS5jYWxscywgZnVuY3Rpb24gKGQpIHsKICAgICAgICByZXR1cm4gZC5pZDsKICAgICAgfSk7CiAgICAgIGFuY2hvci52YWx1ZS5leGl0KCkucmVtb3ZlKCk7CiAgICAgIGFuY2hvci52YWx1ZSA9IGFuY2hvckVsZW1lbnQoYW5jaG9yLnZhbHVlLmVudGVyKCksIHsKICAgICAgICBoYW5kbGVMaW5rQ2xpY2s6IGhhbmRsZUxpbmtDbGljaywKICAgICAgICB0aXBIdG1sOiBmdW5jdGlvbiB0aXBIdG1sKGRhdGEpIHsKICAgICAgICAgIHZhciBsaW5rQ2xpZW50TWV0cmljcyA9IHNldHRpbmdzLnZhbHVlLmxpbmtDbGllbnRNZXRyaWNzIHx8IFtdOwogICAgICAgICAgdmFyIGxpbmtTZXJ2ZXJNZXRyaWNDb25maWcgPSBzZXR0aW5ncy52YWx1ZS5saW5rU2VydmVyTWV0cmljQ29uZmlnIHx8IFtdOwogICAgICAgICAgdmFyIGxpbmtDbGllbnRNZXRyaWNDb25maWcgPSBzZXR0aW5ncy52YWx1ZS5saW5rQ2xpZW50TWV0cmljQ29uZmlnIHx8IFtdOwogICAgICAgICAgdmFyIGxpbmtTZXJ2ZXJNZXRyaWNzID0gc2V0dGluZ3MudmFsdWUubGlua1NlcnZlck1ldHJpY3MgfHwgW107CiAgICAgICAgICB2YXIgaHRtbFNlcnZlciA9IGxpbmtTZXJ2ZXJNZXRyaWNzLm1hcChmdW5jdGlvbiAobSwgaW5kZXgpIHsKICAgICAgICAgICAgdmFyIG1ldHJpYyA9IHRvcG9sb2d5U3RvcmUubGlua1NlcnZlck1ldHJpY3NbbV0udmFsdWVzLmZpbmQoZnVuY3Rpb24gKHZhbCkgewogICAgICAgICAgICAgIHJldHVybiB2YWwuaWQgPT09IGRhdGEuaWQ7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgaWYgKG1ldHJpYykgewogICAgICAgICAgICAgIHZhciBvcHQgPSBsaW5rU2VydmVyTWV0cmljQ29uZmlnW2luZGV4XSB8fCB7fTsKICAgICAgICAgICAgICB2YXIgdiA9IGFnZ3JlZ2F0aW9uKG1ldHJpYy52YWx1ZSwgb3B0KTsKICAgICAgICAgICAgICByZXR1cm4gIiA8ZGl2IGNsYXNzPVwibWItNVwiPjxzcGFuIGNsYXNzPVwiZ3JleVwiPiIuY29uY2F0KG9wdC5sYWJlbCB8fCBtLCAiOiA8L3NwYW4+IikuY29uY2F0KHYsICIgIikuY29uY2F0KG9wdC51bml0IHx8ICIiLCAiPC9kaXY+Iik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgICAgdmFyIGh0bWxDbGllbnQgPSBsaW5rQ2xpZW50TWV0cmljcy5tYXAoZnVuY3Rpb24gKG0sIGluZGV4KSB7CiAgICAgICAgICAgIHZhciBvcHQgPSBsaW5rQ2xpZW50TWV0cmljQ29uZmlnW2luZGV4XSB8fCB7fTsKICAgICAgICAgICAgdmFyIG1ldHJpYyA9IHRvcG9sb2d5U3RvcmUubGlua0NsaWVudE1ldHJpY3NbbV0udmFsdWVzLmZpbmQoZnVuY3Rpb24gKHZhbCkgewogICAgICAgICAgICAgIHJldHVybiB2YWwuaWQgPT09IGRhdGEuaWQ7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgaWYgKG1ldHJpYykgewogICAgICAgICAgICAgIHZhciB2ID0gYWdncmVnYXRpb24obWV0cmljLnZhbHVlLCBvcHQpOwogICAgICAgICAgICAgIHJldHVybiAiIDxkaXYgY2xhc3M9XCJtYi01XCI+PHNwYW4gY2xhc3M9XCJncmV5XCI+Ii5jb25jYXQob3B0LmxhYmVsIHx8IG0sICI6IDwvc3Bhbj4iKS5jb25jYXQodiwgIiAiKS5jb25jYXQob3B0LnVuaXQgfHwgIiIsICI8L2Rpdj4iKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgICB2YXIgaHRtbCA9IFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoaHRtbFNlcnZlciksIF90b0NvbnN1bWFibGVBcnJheShodG1sQ2xpZW50KSwgWyI8ZGl2PjxzcGFuIGNsYXNzPVwiZ3JleVwiPiIuY29uY2F0KHQoImRldGVjdFBvaW50IiksICI6PC9zcGFuPiIpLmNvbmNhdChkYXRhLmRldGVjdFBvaW50cy5qb2luKCIgfCAiKSwgIjwvZGl2PiIpXSkuam9pbigiICIpOwogICAgICAgICAgcmV0dXJuIGh0bWw7CiAgICAgICAgfQogICAgICB9LCB0aXAudmFsdWUpLm1lcmdlKGFuY2hvci52YWx1ZSk7IC8vIGFycm93IG1hcmtlcgoKICAgICAgYXJyb3cudmFsdWUgPSBhcnJvdy52YWx1ZS5kYXRhKHRvcG9sb2d5U3RvcmUuY2FsbHMsIGZ1bmN0aW9uIChkKSB7CiAgICAgICAgcmV0dXJuIGQuaWQ7CiAgICAgIH0pOwogICAgICBhcnJvdy52YWx1ZS5leGl0KCkucmVtb3ZlKCk7CiAgICAgIGFycm93LnZhbHVlID0gYXJyb3dNYXJrZXIoYXJyb3cudmFsdWUuZW50ZXIoKSkubWVyZ2UoYXJyb3cudmFsdWUpOyAvLyBmb3JjZSBlbGVtZW50CgogICAgICBzaW11bGF0aW9uLnZhbHVlLm5vZGVzKHRvcG9sb2d5U3RvcmUubm9kZXMpOwogICAgICBzaW11bGF0aW9uLnZhbHVlLmZvcmNlKCJsaW5rIikubGlua3ModG9wb2xvZ3lTdG9yZS5jYWxscykuaWQoZnVuY3Rpb24gKGQpIHsKICAgICAgICByZXR1cm4gZC5pZDsKICAgICAgfSk7CiAgICAgIHNpbXVsYXRpb25Ta2lwKGQzLCBzaW11bGF0aW9uLnZhbHVlLCB0aWNrZWQpOwogICAgICB2YXIgbG9vcE1hcCA9IHt9OwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0b3BvbG9neVN0b3JlLmNhbGxzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmFyIF9saW5rID0gdG9wb2xvZ3lTdG9yZS5jYWxsc1tpXTsKICAgICAgICBfbGluay5sb29wRmFjdG9yID0gMTsKCiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0b3BvbG9neVN0b3JlLmNhbGxzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICBpZiAoaSA9PT0gaiB8fCBsb29wTWFwW2ldKSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciBvdGhlckxpbmsgPSB0b3BvbG9neVN0b3JlLmNhbGxzW2pdOwoKICAgICAgICAgIGlmIChfbGluay5zb3VyY2UuaWQgPT09IG90aGVyTGluay50YXJnZXQuaWQgJiYgX2xpbmsudGFyZ2V0LmlkID09PSBvdGhlckxpbmsuc291cmNlLmlkKSB7CiAgICAgICAgICAgIF9saW5rLmxvb3BGYWN0b3IgPSAtMTsKICAgICAgICAgICAgbG9vcE1hcFtqXSA9IDE7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGhhbmRsZUluc3BlY3QoKSB7CiAgICAgIHJldHVybiBfaGFuZGxlSW5zcGVjdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgfQoKICAgIGZ1bmN0aW9uIF9oYW5kbGVJbnNwZWN0KCkgewogICAgICBfaGFuZGxlSW5zcGVjdCA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQoKSB7CiAgICAgICAgdmFyIGlkLCByZXNwOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBzdmcudmFsdWUuc2VsZWN0QWxsKCIudG9wby1zdmctZ3JhcGgiKS5yZW1vdmUoKTsKICAgICAgICAgICAgICAgIGlkID0gdG9wb2xvZ3lTdG9yZS5ub2RlLmlkOwogICAgICAgICAgICAgICAgdG9wb2xvZ3lTdG9yZS5zZXROb2RlKG51bGwpOwogICAgICAgICAgICAgICAgdG9wb2xvZ3lTdG9yZS5zZXRMaW5rKG51bGwpOwogICAgICAgICAgICAgICAgbG9hZGluZy52YWx1ZSA9IHRydWU7CiAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDc7CiAgICAgICAgICAgICAgICByZXR1cm4gdG9wb2xvZ3lTdG9yZS5nZXREZXB0aFNlcnZpY2VUb3BvbG9neShbaWRdLCBOdW1iZXIoZGVwdGgudmFsdWUpKTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgcmVzcCA9IF9jb250ZXh0NC5zZW50OwogICAgICAgICAgICAgICAgbG9hZGluZy52YWx1ZSA9IGZhbHNlOwoKICAgICAgICAgICAgICAgIGlmIChyZXNwICYmIHJlc3AuZXJyb3JzKSB7CiAgICAgICAgICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcihyZXNwLmVycm9ycyk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAxMjsKICAgICAgICAgICAgICAgIHJldHVybiBpbml0KCk7CgogICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgICB1cGRhdGUoKTsKCiAgICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNCk7CiAgICAgIH0pKTsKICAgICAgcmV0dXJuIF9oYW5kbGVJbnNwZWN0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9CgogICAgZnVuY3Rpb24gaGFuZGxlR29FbmRwb2ludChuYW1lKSB7CiAgICAgIHZhciBwYXRoID0gIi9kYXNoYm9hcmQvIi5jb25jYXQoZGFzaGJvYXJkU3RvcmUubGF5ZXJJZCwgIi8iKS5jb25jYXQoRW50aXR5VHlwZVsyXS52YWx1ZSwgIi8iKS5jb25jYXQodG9wb2xvZ3lTdG9yZS5ub2RlLmlkLCAiLyIpLmNvbmNhdChuYW1lKTsKICAgICAgdmFyIHJvdXRlVXJsID0gcm91dGVyLnJlc29sdmUoewogICAgICAgIHBhdGg6IHBhdGgKICAgICAgfSk7CiAgICAgIHdpbmRvdy5vcGVuKHJvdXRlVXJsLmhyZWYsICJfYmxhbmsiKTsKICAgICAgZGFzaGJvYXJkU3RvcmUuc2V0RW50aXR5KG9yaWdpbik7CiAgICB9CgogICAgZnVuY3Rpb24gaGFuZGxlR29JbnN0YW5jZShuYW1lKSB7CiAgICAgIHZhciBwYXRoID0gIi9kYXNoYm9hcmQvIi5jb25jYXQoZGFzaGJvYXJkU3RvcmUubGF5ZXJJZCwgIi8iKS5jb25jYXQoRW50aXR5VHlwZVszXS52YWx1ZSwgIi8iKS5jb25jYXQodG9wb2xvZ3lTdG9yZS5ub2RlLmlkLCAiLyIpLmNvbmNhdChuYW1lKTsKICAgICAgdmFyIHJvdXRlVXJsID0gcm91dGVyLnJlc29sdmUoewogICAgICAgIHBhdGg6IHBhdGgKICAgICAgfSk7CiAgICAgIHdpbmRvdy5vcGVuKHJvdXRlVXJsLmhyZWYsICJfYmxhbmsiKTsKICAgICAgZGFzaGJvYXJkU3RvcmUuc2V0RW50aXR5KG9yaWdpbik7CiAgICB9CgogICAgZnVuY3Rpb24gaGFuZGxlR29EYXNoYm9hcmQobmFtZSkgewogICAgICB2YXIgcGF0aCA9ICIvZGFzaGJvYXJkLyIuY29uY2F0KGRhc2hib2FyZFN0b3JlLmxheWVySWQsICIvIikuY29uY2F0KEVudGl0eVR5cGVbMF0udmFsdWUsICIvIikuY29uY2F0KHRvcG9sb2d5U3RvcmUubm9kZS5pZCwgIi8iKS5jb25jYXQobmFtZSk7CiAgICAgIHZhciByb3V0ZVVybCA9IHJvdXRlci5yZXNvbHZlKHsKICAgICAgICBwYXRoOiBwYXRoCiAgICAgIH0pOwogICAgICB3aW5kb3cub3Blbihyb3V0ZVVybC5ocmVmLCAiX2JsYW5rIik7CiAgICAgIGRhc2hib2FyZFN0b3JlLnNldEVudGl0eShvcmlnaW4pOwogICAgfQoKICAgIGZ1bmN0aW9uIGhhbmRsZUdvQWxhcm0oKSB7CiAgICAgIHZhciBwYXRoID0gIi9hbGFybSI7CiAgICAgIHZhciByb3V0ZVVybCA9IHJvdXRlci5yZXNvbHZlKHsKICAgICAgICBwYXRoOiBwYXRoCiAgICAgIH0pOwogICAgICB3aW5kb3cub3Blbihyb3V0ZVVybC5ocmVmLCAiX2JsYW5rIik7CiAgICB9CgogICAgZnVuY3Rpb24gYmFja1RvVG9wb2xvZ3koKSB7CiAgICAgIHJldHVybiBfYmFja1RvVG9wb2xvZ3kuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH0KCiAgICBmdW5jdGlvbiBfYmFja1RvVG9wb2xvZ3koKSB7CiAgICAgIF9iYWNrVG9Ub3BvbG9neSA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTUoKSB7CiAgICAgICAgdmFyIHJlc3A7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU1JChfY29udGV4dDUpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ1LnByZXYgPSBfY29udGV4dDUubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHN2Zy52YWx1ZS5zZWxlY3RBbGwoIi50b3BvLXN2Zy1ncmFwaCIpLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgbG9hZGluZy52YWx1ZSA9IHRydWU7CiAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0VG9wb2xvZ3koKTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgcmVzcCA9IF9jb250ZXh0NS5zZW50OwogICAgICAgICAgICAgICAgbG9hZGluZy52YWx1ZSA9IGZhbHNlOwoKICAgICAgICAgICAgICAgIGlmIChyZXNwICYmIHJlc3AuZXJyb3JzKSB7CiAgICAgICAgICAgICAgICAgIEVsTWVzc2FnZS5lcnJvcihyZXNwLmVycm9ycyk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSA5OwogICAgICAgICAgICAgICAgcmV0dXJuIGluaXQoKTsKCiAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgICAgdXBkYXRlKCk7CiAgICAgICAgICAgICAgICB0b3BvbG9neVN0b3JlLnNldE5vZGUobnVsbCk7CiAgICAgICAgICAgICAgICB0b3BvbG9neVN0b3JlLnNldExpbmsobnVsbCk7CgogICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTUpOwogICAgICB9KSk7CiAgICAgIHJldHVybiBfYmFja1RvVG9wb2xvZ3kuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRUb3BvbG9neSgpIHsKICAgICAgcmV0dXJuIF9nZXRUb3BvbG9neS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgfQoKICAgIGZ1bmN0aW9uIF9nZXRUb3BvbG9neSgpIHsKICAgICAgX2dldFRvcG9sb2d5ID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNigpIHsKICAgICAgICB2YXIgaWRzLCBzZXJ2aWNlSWRzLCByZXNwOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNiQoX2NvbnRleHQ2KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ni5wcmV2ID0gX2NvbnRleHQ2Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBpZHMgPSBzZWxlY3RvclN0b3JlLnNlcnZpY2VzLm1hcChmdW5jdGlvbiAoZCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gZC5pZDsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgc2VydmljZUlkcyA9IGRhc2hib2FyZFN0b3JlLmVudGl0eSA9PT0gRW50aXR5VHlwZVswXS52YWx1ZSA/IFtzZWxlY3RvclN0b3JlLmN1cnJlbnRTZXJ2aWNlLmlkXSA6IGlkczsKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gNDsKICAgICAgICAgICAgICAgIHJldHVybiB0b3BvbG9neVN0b3JlLmdldERlcHRoU2VydmljZVRvcG9sb2d5KHNlcnZpY2VJZHMsIE51bWJlcihkZXB0aC52YWx1ZSkpOwoKICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICByZXNwID0gX2NvbnRleHQ2LnNlbnQ7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LmFicnVwdCgicmV0dXJuIiwgcmVzcCk7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNik7CiAgICAgIH0pKTsKICAgICAgcmV0dXJuIF9nZXRUb3BvbG9neS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldENvbmZpZygpIHsKICAgICAgc2hvd1NldHRpbmcudmFsdWUgPSAhc2hvd1NldHRpbmcudmFsdWU7CiAgICAgIGRhc2hib2FyZFN0b3JlLnNlbGVjdFdpZGdldChwcm9wcy5jb25maWcpOwogICAgfQoKICAgIGZ1bmN0aW9uIHJlc2l6ZSgpIHsKICAgICAgdmFyIF9kb2N1bWVudCRxdWVyeVNlbGVjdDI7CgogICAgICB2YXIgZG9tID0gKChfZG9jdW1lbnQkcXVlcnlTZWxlY3QyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLnRvcG9sb2d5IikpID09PSBudWxsIHx8IF9kb2N1bWVudCRxdWVyeVNlbGVjdDIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9kb2N1bWVudCRxdWVyeVNlbGVjdDIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkpIHx8IHsKICAgICAgICBoZWlnaHQ6IDQwLAogICAgICAgIHdpZHRoOiAwCiAgICAgIH07CiAgICAgIGhlaWdodC52YWx1ZSA9IGRvbS5oZWlnaHQgLSA0MDsKICAgICAgd2lkdGgudmFsdWUgPSBkb20ud2lkdGg7CiAgICAgIHN2Zy52YWx1ZS5hdHRyKCJoZWlnaHQiLCBoZWlnaHQudmFsdWUpLmF0dHIoIndpZHRoIiwgd2lkdGgudmFsdWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIHVwZGF0ZVNldHRpbmdzKGNvbmZpZykgewogICAgICBzZXR0aW5ncy52YWx1ZSA9IGNvbmZpZzsKICAgICAgc2V0Tm9kZVRvb2xzKGNvbmZpZy5ub2RlRGFzaGJvYXJkKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXROb2RlVG9vbHMobm9kZURhc2hib2FyZCkgewogICAgICBpdGVtcy52YWx1ZSA9IFt7CiAgICAgICAgaWQ6ICJpbnNwZWN0IiwKICAgICAgICB0aXRsZTogIkluc3BlY3QiLAogICAgICAgIGZ1bmM6IGhhbmRsZUluc3BlY3QKICAgICAgfSwgewogICAgICAgIGlkOiAiYWxhcm0iLAogICAgICAgIHRpdGxlOiAiQWxhcm0iLAogICAgICAgIGZ1bmM6IGhhbmRsZUdvQWxhcm0KICAgICAgfV07CgogICAgICBpZiAoIShub2RlRGFzaGJvYXJkICYmIG5vZGVEYXNoYm9hcmQubGVuZ3RoKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIF9pdGVyYXRvciA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKG5vZGVEYXNoYm9hcmQpLAogICAgICAgICAgX3N0ZXA7CgogICAgICB0cnkgewogICAgICAgIGZvciAoX2l0ZXJhdG9yLnMoKTsgIShfc3RlcCA9IF9pdGVyYXRvci5uKCkpLmRvbmU7KSB7CiAgICAgICAgICB2YXIgaXRlbSA9IF9zdGVwLnZhbHVlOwoKICAgICAgICAgIGlmIChpdGVtLnNjb3BlID09PSBFbnRpdHlUeXBlWzBdLnZhbHVlKSB7CiAgICAgICAgICAgIGl0ZW1zLnZhbHVlLnB1c2goX29iamVjdFNwcmVhZCh7CiAgICAgICAgICAgICAgaWQ6ICJkYXNoYm9hcmQiLAogICAgICAgICAgICAgIHRpdGxlOiAiU2VydmljZSBEYXNoYm9hcmQiLAogICAgICAgICAgICAgIGZ1bmM6IGhhbmRsZUdvRGFzaGJvYXJkCiAgICAgICAgICAgIH0sIGl0ZW0pKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoaXRlbS5zY29wZSA9PT0gRW50aXR5VHlwZVsyXS52YWx1ZSkgewogICAgICAgICAgICBpdGVtcy52YWx1ZS5wdXNoKF9vYmplY3RTcHJlYWQoewogICAgICAgICAgICAgIGlkOiAiZW5kcG9pbnQiLAogICAgICAgICAgICAgIHRpdGxlOiAiRW5kcG9pbnQgRGFzaGJvYXJkIiwKICAgICAgICAgICAgICBmdW5jOiBoYW5kbGVHb0VuZHBvaW50CiAgICAgICAgICAgIH0sIGl0ZW0pKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoaXRlbS5zY29wZSA9PT0gRW50aXR5VHlwZVszXS52YWx1ZSkgewogICAgICAgICAgICBpdGVtcy52YWx1ZS5wdXNoKF9vYmplY3RTcHJlYWQoewogICAgICAgICAgICAgIGlkOiAiaW5zdGFuY2UiLAogICAgICAgICAgICAgIHRpdGxlOiAiU2VydmljZSBJbnN0YW5jZSBEYXNoYm9hcmQiLAogICAgICAgICAgICAgIGZ1bmM6IGhhbmRsZUdvSW5zdGFuY2UKICAgICAgICAgICAgfSwgaXRlbSkpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgX2l0ZXJhdG9yLmUoZXJyKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBfaXRlcmF0b3IuZigpOwogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gZnJlc2hOb2RlcygpIHsKICAgICAgcmV0dXJuIF9mcmVzaE5vZGVzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9CgogICAgZnVuY3Rpb24gX2ZyZXNoTm9kZXMoKSB7CiAgICAgIF9mcmVzaE5vZGVzID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNygpIHsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTckKF9jb250ZXh0NykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDcucHJldiA9IF9jb250ZXh0Ny5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgaWYgKHN2Zy52YWx1ZSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDI7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgc3ZnLnZhbHVlLnNlbGVjdEFsbCgiLnRvcG8tc3ZnLWdyYXBoIikucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDU7CiAgICAgICAgICAgICAgICByZXR1cm4gaW5pdCgpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICB1cGRhdGUoKTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU3KTsKICAgICAgfSkpOwogICAgICByZXR1cm4gX2ZyZXNoTm9kZXMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH0KCiAgICBmdW5jdGlvbiBjaGFuZ2VEZXB0aChfeCkgewogICAgICByZXR1cm4gX2NoYW5nZURlcHRoLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9CgogICAgZnVuY3Rpb24gX2NoYW5nZURlcHRoKCkgewogICAgICBfY2hhbmdlRGVwdGggPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU4KG9wdCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlOCQoX2NvbnRleHQ4KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0OC5wcmV2ID0gX2NvbnRleHQ4Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBkZXB0aC52YWx1ZSA9IG9wdFswXS52YWx1ZTsKICAgICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gMzsKICAgICAgICAgICAgICAgIHJldHVybiBnZXRUb3BvbG9neSgpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBmcmVzaE5vZGVzKCk7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlOCk7CiAgICAgIH0pKTsKICAgICAgcmV0dXJuIF9jaGFuZ2VEZXB0aC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgfQoKICAgIG9uQmVmb3JlVW5tb3VudChmdW5jdGlvbiAoKSB7CiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJyZXNpemUiLCByZXNpemUpOwogICAgfSk7CiAgICB3YXRjaChmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBbc2VsZWN0b3JTdG9yZS5jdXJyZW50U2VydmljZSwgc2VsZWN0b3JTdG9yZS5jdXJyZW50RGVzdFNlcnZpY2VdOwogICAgfSwgZnVuY3Rpb24gKCkgewogICAgICBmcmVzaE5vZGVzKCk7CiAgICB9KTsKICAgIHdhdGNoKGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIGFwcFN0b3JlLmR1cmF0aW9uVGltZTsKICAgIH0sIGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKGRhc2hib2FyZFN0b3JlLmVudGl0eSA9PT0gRW50aXR5VHlwZVsxXS52YWx1ZSkgewogICAgICAgIGZyZXNoTm9kZXMoKTsKICAgICAgfQogICAgfSk7CiAgICByZXR1cm4gZnVuY3Rpb24gKF9jdHgsIF9jYWNoZSkgewogICAgICB2YXIgX2NvbXBvbmVudF9TZWxlY3RvciA9IF9yZXNvbHZlQ29tcG9uZW50KCJTZWxlY3RvciIpOwoKICAgICAgdmFyIF9jb21wb25lbnRfSWNvbiA9IF9yZXNvbHZlQ29tcG9uZW50KCJJY29uIik7CgogICAgICB2YXIgX2RpcmVjdGl2ZV9sb2FkaW5nID0gX3Jlc29sdmVEaXJlY3RpdmUoImxvYWRpbmciKTsKCiAgICAgIHJldHVybiBfd2l0aERpcmVjdGl2ZXMoKF9vcGVuQmxvY2soKSwgX2NyZWF0ZUVsZW1lbnRCbG9jaygiZGl2IiwgewogICAgICAgIHJlZl9rZXk6ICJjaGFydCIsCiAgICAgICAgcmVmOiBjaGFydCwKICAgICAgICBjbGFzczogIm1pY3JvLXRvcG8tY2hhcnQiLAogICAgICAgICJlbGVtZW50LWxvYWRpbmctYmFja2dyb3VuZCI6ICJyZ2JhKDAsIDAsIDAsIDApIiwKICAgICAgICBzdHlsZTogX25vcm1hbGl6ZVN0eWxlKCJoZWlnaHQ6ICIuY29uY2F0KGhlaWdodC52YWx1ZSwgInB4IikpCiAgICAgIH0sIFtfY3JlYXRlRWxlbWVudFZOb2RlKCJkaXYiLCBfaG9pc3RlZF8xLCBbX2NyZWF0ZUVsZW1lbnRWTm9kZSgiZGl2IiwgbnVsbCwgW19jcmVhdGVFbGVtZW50Vk5vZGUoImltZyIsIHsKICAgICAgICBzcmM6IF91bnJlZihpY29ucykuQ1VCRQogICAgICB9LCBudWxsLCA4LCBfaG9pc3RlZF8yKSwgX2NyZWF0ZUVsZW1lbnRWTm9kZSgic3BhbiIsIG51bGwsIF90b0Rpc3BsYXlTdHJpbmcoc2V0dGluZ3MudmFsdWUuZGVzY3JpcHRpb24gPyBzZXR0aW5ncy52YWx1ZS5kZXNjcmlwdGlvbi5oZWFsdGh5IHx8ICIiIDogIiIpLCAxKV0pLCBfY3JlYXRlRWxlbWVudFZOb2RlKCJkaXYiLCBudWxsLCBbX2NyZWF0ZUVsZW1lbnRWTm9kZSgiaW1nIiwgewogICAgICAgIHNyYzogX3VucmVmKGljb25zKS5DVUJFRVJST1IKICAgICAgfSwgbnVsbCwgOCwgX2hvaXN0ZWRfMyksIF9jcmVhdGVFbGVtZW50Vk5vZGUoInNwYW4iLCBudWxsLCBfdG9EaXNwbGF5U3RyaW5nKHNldHRpbmdzLnZhbHVlLmRlc2NyaXB0aW9uID8gc2V0dGluZ3MudmFsdWUuZGVzY3JpcHRpb24udW5oZWFsdGh5IHx8ICIiIDogIiIpLCAxKV0pXSksIHNob3dTZXR0aW5nLnZhbHVlICYmIF91bnJlZihkYXNoYm9hcmRTdG9yZSkuZWRpdE1vZGUgPyAoX29wZW5CbG9jaygpLCBfY3JlYXRlRWxlbWVudEJsb2NrKCJkaXYiLCBfaG9pc3RlZF80LCBbX2NyZWF0ZVZOb2RlKFNldHRpbmdzLCB7CiAgICAgICAgb25VcGRhdGU6IHVwZGF0ZVNldHRpbmdzLAogICAgICAgIG9uVXBkYXRlTm9kZXM6IGZyZXNoTm9kZXMKICAgICAgfSldKSkgOiBfY3JlYXRlQ29tbWVudFZOb2RlKCIiLCB0cnVlKSwgX2NyZWF0ZUVsZW1lbnRWTm9kZSgiZGl2IiwgX2hvaXN0ZWRfNSwgW193aXRoRGlyZWN0aXZlcyhfY3JlYXRlRWxlbWVudFZOb2RlKCJzcGFuIiwgbnVsbCwgW19jcmVhdGVFbGVtZW50Vk5vZGUoInNwYW4iLCBfaG9pc3RlZF82LCBfdG9EaXNwbGF5U3RyaW5nKF91bnJlZih0KSgiY3VycmVudERlcHRoIikpLCAxKSwgX2NyZWF0ZVZOb2RlKF9jb21wb25lbnRfU2VsZWN0b3IsIHsKICAgICAgICBjbGFzczogImlucHV0cyIsCiAgICAgICAgdmFsdWU6IGRlcHRoLnZhbHVlLAogICAgICAgIG9wdGlvbnM6IF91bnJlZihEZXB0aExpc3QpLAogICAgICAgIG9uQ2hhbmdlOiBjaGFuZ2VEZXB0aAogICAgICB9LCBudWxsLCA4LCBbInZhbHVlIiwgIm9wdGlvbnMiXSldLCA1MTIpLCBbW192U2hvdywgX3VucmVmKGdyYXBoQ29uZmlnKS5zaG93RGVwdGhdXSksIF91bnJlZihkYXNoYm9hcmRTdG9yZSkuZWRpdE1vZGUgPyAoX29wZW5CbG9jaygpLCBfY3JlYXRlRWxlbWVudEJsb2NrKCJzcGFuIiwgewogICAgICAgIGtleTogMCwKICAgICAgICBjbGFzczogInN3aXRjaC1pY29uIG1sLTUiLAogICAgICAgIHRpdGxlOiAiU2V0dGluZ3MiLAogICAgICAgIG9uQ2xpY2s6IHNldENvbmZpZwogICAgICB9LCBbX2NyZWF0ZVZOb2RlKF9jb21wb25lbnRfSWNvbiwgewogICAgICAgIHNpemU6ICJtaWRkbGUiLAogICAgICAgIGljb25OYW1lOiAic2V0dGluZ3MiCiAgICAgIH0pXSkpIDogX2NyZWF0ZUNvbW1lbnRWTm9kZSgiIiwgdHJ1ZSksIF9jcmVhdGVFbGVtZW50Vk5vZGUoInNwYW4iLCB7CiAgICAgICAgY2xhc3M6ICJzd2l0Y2gtaWNvbiBtbC01IiwKICAgICAgICB0aXRsZTogIkJhY2sgdG8gb3ZlcnZpZXcgdG9wb2xvZ3kiLAogICAgICAgIG9uQ2xpY2s6IGJhY2tUb1RvcG9sb2d5CiAgICAgIH0sIFtfY3JlYXRlVk5vZGUoX2NvbXBvbmVudF9JY29uLCB7CiAgICAgICAgc2l6ZTogIm1pZGRsZSIsCiAgICAgICAgaWNvbk5hbWU6ICJrZXlib2FyZF9iYWNrc3BhY2UiCiAgICAgIH0pXSldKSwgX3VucmVmKHRvcG9sb2d5U3RvcmUpLm5vZGUgPyAoX29wZW5CbG9jaygpLCBfY3JlYXRlRWxlbWVudEJsb2NrKCJkaXYiLCB7CiAgICAgICAga2V5OiAxLAogICAgICAgIGNsYXNzOiAib3BlcmF0aW9ucy1saXN0IiwKICAgICAgICBzdHlsZTogX25vcm1hbGl6ZVN0eWxlKHsKICAgICAgICAgIHRvcDogX3VucmVmKG9wZXJhdGlvbnNQb3MpLnkgKyAncHgnLAogICAgICAgICAgbGVmdDogX3VucmVmKG9wZXJhdGlvbnNQb3MpLnggKyAncHgnCiAgICAgICAgfSkKICAgICAgfSwgWyhfb3BlbkJsb2NrKHRydWUpLCBfY3JlYXRlRWxlbWVudEJsb2NrKF9GcmFnbWVudCwgbnVsbCwgX3JlbmRlckxpc3QoaXRlbXMudmFsdWUsIGZ1bmN0aW9uIChpdGVtLCBpbmRleCkgewogICAgICAgIHJldHVybiBfb3BlbkJsb2NrKCksIF9jcmVhdGVFbGVtZW50QmxvY2soInNwYW4iLCB7CiAgICAgICAgICBrZXk6IGluZGV4LAogICAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygkZXZlbnQpIHsKICAgICAgICAgICAgcmV0dXJuIGl0ZW0uZnVuYyhpdGVtLmRhc2hib2FyZCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgX3RvRGlzcGxheVN0cmluZyhpdGVtLnRpdGxlKSwgOSwgX2hvaXN0ZWRfNyk7CiAgICAgIH0pLCAxMjgpKV0sIDQpKSA6IF9jcmVhdGVDb21tZW50Vk5vZGUoIiIsIHRydWUpXSwgNCkpLCBbW19kaXJlY3RpdmVfbG9hZGluZywgbG9hZGluZy52YWx1ZV1dKTsKICAgIH07CiAgfQp9KTs="},null]}