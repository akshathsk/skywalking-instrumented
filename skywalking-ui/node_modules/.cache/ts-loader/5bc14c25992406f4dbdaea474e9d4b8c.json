{"remainingRequest":"/home/sk117/final-project/apache-skywalking-apm-9.2.0/skywalking-ui/node_modules/thread-loader/dist/cjs.js!/home/sk117/final-project/apache-skywalking-apm-9.2.0/skywalking-ui/node_modules/babel-loader/lib/index.js!/home/sk117/final-project/apache-skywalking-apm-9.2.0/skywalking-ui/node_modules/ts-loader/index.js??ref--15-3!/home/sk117/final-project/apache-skywalking-apm-9.2.0/skywalking-ui/node_modules/cache-loader/dist/cjs.js??ref--1-0!/home/sk117/final-project/apache-skywalking-apm-9.2.0/skywalking-ui/node_modules/vue-loader-v16/dist/index.js??ref--1-1!/home/sk117/final-project/apache-skywalking-apm-9.2.0/skywalking-ui/src/views/dashboard/related/topology/components/Graph.vue?vue&type=script&lang=ts&setup=true","dependencies":[{"path":"/home/sk117/final-project/apache-skywalking-apm-9.2.0/skywalking-ui/src/views/dashboard/related/topology/components/Graph.vue","mtime":1661850019000},{"path":"/home/sk117/final-project/apache-skywalking-apm-9.2.0/skywalking-ui/babel.config.js","mtime":1661850018000},{"path":"/home/sk117/final-project/apache-skywalking-apm-9.2.0/skywalking-ui/node_modules/unplugin/dist/webpack/loaders/transform.js","mtime":1663881224252},{"path":"/home/sk117/final-project/apache-skywalking-apm-9.2.0/skywalking-ui/node_modules/unplugin/dist/webpack/loaders/transform.js","mtime":1663881224252},{"path":"/home/sk117/final-project/apache-skywalking-apm-9.2.0/skywalking-ui/node_modules/unplugin/dist/webpack/loaders/transform.js","mtime":1663881224252},{"path":"/home/sk117/final-project/apache-skywalking-apm-9.2.0/skywalking-ui/node_modules/unplugin/dist/webpack/loaders/transform.js","mtime":1663881224252},{"path":"/home/sk117/final-project/apache-skywalking-apm-9.2.0/skywalking-ui/node_modules/cache-loader/dist/cjs.js","mtime":1663881222784},{"path":"/home/sk117/final-project/apache-skywalking-apm-9.2.0/skywalking-ui/node_modules/thread-loader/dist/cjs.js","mtime":1663881222612},{"path":"/home/sk117/final-project/apache-skywalking-apm-9.2.0/skywalking-ui/node_modules/babel-loader/lib/index.js","mtime":1663881224500},{"path":"/home/sk117/final-project/apache-skywalking-apm-9.2.0/skywalking-ui/node_modules/ts-loader/index.js","mtime":1663881224684},{"path":"/home/sk117/final-project/apache-skywalking-apm-9.2.0/skywalking-ui/node_modules/cache-loader/dist/cjs.js","mtime":1663881222784},{"path":"/home/sk117/final-project/apache-skywalking-apm-9.2.0/skywalking-ui/node_modules/vue-loader-v16/dist/index.js","mtime":1663881224404}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiL2hvbWUvc2sxMTcvZmluYWwtcHJvamVjdC9hcGFjaGUtc2t5d2Fsa2luZy1hcG0tOS4yLjAvc2t5d2Fsa2luZy11aS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0U3ByZWFkMi5qcyI7CmltcG9ydCBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciBmcm9tICIvaG9tZS9zazExNy9maW5hbC1wcm9qZWN0L2FwYWNoZS1za3l3YWxraW5nLWFwbS05LjIuMC9za3l3YWxraW5nLXVpL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyLmpzIjsKaW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICIvaG9tZS9zazExNy9maW5hbC1wcm9qZWN0L2FwYWNoZS1za3l3YWxraW5nLWFwbS05LjIuMC9za3l3YWxraW5nLXVpL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90b0NvbnN1bWFibGVBcnJheS5qcyI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICIvaG9tZS9zazExNy9maW5hbC1wcm9qZWN0L2FwYWNoZS1za3l3YWxraW5nLWFwbS05LjIuMC9za3l3YWxraW5nLXVpL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5qb2luLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmRlc2NyaXB0aW9uLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubnVtYmVyLmNvbnN0cnVjdG9yLmpzIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgeyBkZWZpbmVDb21wb25lbnQgYXMgX2RlZmluZUNvbXBvbmVudCB9IGZyb20gJ3Z1ZSc7CmltcG9ydCB7IHVucmVmIGFzIF91bnJlZiwgY3JlYXRlRWxlbWVudFZOb2RlIGFzIF9jcmVhdGVFbGVtZW50Vk5vZGUsIHRvRGlzcGxheVN0cmluZyBhcyBfdG9EaXNwbGF5U3RyaW5nLCBjcmVhdGVWTm9kZSBhcyBfY3JlYXRlVk5vZGUsIG9wZW5CbG9jayBhcyBfb3BlbkJsb2NrLCBjcmVhdGVFbGVtZW50QmxvY2sgYXMgX2NyZWF0ZUVsZW1lbnRCbG9jaywgY3JlYXRlQ29tbWVudFZOb2RlIGFzIF9jcmVhdGVDb21tZW50Vk5vZGUsIHJlc29sdmVDb21wb25lbnQgYXMgX3Jlc29sdmVDb21wb25lbnQsIHZTaG93IGFzIF92U2hvdywgd2l0aERpcmVjdGl2ZXMgYXMgX3dpdGhEaXJlY3RpdmVzLCByZW5kZXJMaXN0IGFzIF9yZW5kZXJMaXN0LCBGcmFnbWVudCBhcyBfRnJhZ21lbnQsIG5vcm1hbGl6ZVN0eWxlIGFzIF9ub3JtYWxpemVTdHlsZSwgcmVzb2x2ZURpcmVjdGl2ZSBhcyBfcmVzb2x2ZURpcmVjdGl2ZSB9IGZyb20gInZ1ZSI7CnZhciBfaG9pc3RlZF8xID0gewogIGNsYXNzOiAibGVnZW5kIgp9Owp2YXIgX2hvaXN0ZWRfMiA9IFsic3JjIl07CnZhciBfaG9pc3RlZF8zID0gWyJzcmMiXTsKdmFyIF9ob2lzdGVkXzQgPSB7CiAga2V5OiAwLAogIGNsYXNzOiAic2V0dGluZyIKfTsKdmFyIF9ob2lzdGVkXzUgPSB7CiAgY2xhc3M6ICJ0b29sIgp9Owp2YXIgX2hvaXN0ZWRfNiA9IHsKICBjbGFzczogImxhYmVsIgp9Owp2YXIgX2hvaXN0ZWRfNyA9IFsib25DbGljayJdOwppbXBvcnQgeyByZWYsIG9uTW91bnRlZCwgb25CZWZvcmVVbm1vdW50LCByZWFjdGl2ZSwgd2F0Y2gsIGNvbXB1dGVkIH0gZnJvbSAidnVlIjsKaW1wb3J0IHsgdXNlSTE4biB9IGZyb20gInZ1ZS1pMThuIjsKaW1wb3J0ICogYXMgZDMgZnJvbSAiZDMiOwppbXBvcnQgZDN0aXAgZnJvbSAiZDMtdGlwIjsKaW1wb3J0IHpvb20gZnJvbSAiLi4vLi4vY29tcG9uZW50cy91dGlscy96b29tIjsKaW1wb3J0IHsgc2ltdWxhdGlvbkluaXQsIHNpbXVsYXRpb25Ta2lwIH0gZnJvbSAiLi91dGlscy9zaW11bGF0aW9uIjsKaW1wb3J0IG5vZGVFbGVtZW50IGZyb20gIi4vdXRpbHMvbm9kZUVsZW1lbnQiOwppbXBvcnQgeyBsaW5rRWxlbWVudCwgYW5jaG9yRWxlbWVudCwgYXJyb3dNYXJrZXIgfSBmcm9tICIuL3V0aWxzL2xpbmtFbGVtZW50IjsKaW1wb3J0IHsgdXNlU2VsZWN0b3JTdG9yZSB9IGZyb20gIkAvc3RvcmUvbW9kdWxlcy9zZWxlY3RvcnMiOwppbXBvcnQgeyB1c2VUb3BvbG9neVN0b3JlIH0gZnJvbSAiQC9zdG9yZS9tb2R1bGVzL3RvcG9sb2d5IjsKaW1wb3J0IHsgdXNlRGFzaGJvYXJkU3RvcmUgfSBmcm9tICJAL3N0b3JlL21vZHVsZXMvZGFzaGJvYXJkIjsKaW1wb3J0IHsgRW50aXR5VHlwZSwgRGVwdGhMaXN0IH0gZnJvbSAiLi4vLi4vLi4vZGF0YSI7CmltcG9ydCByb3V0ZXIgZnJvbSAiQC9yb3V0ZXIiOwppbXBvcnQgeyBFbE1lc3NhZ2UgfSBmcm9tICJlbGVtZW50LXBsdXMiOwppbXBvcnQgU2V0dGluZ3MgZnJvbSAiLi9TZXR0aW5ncy52dWUiOwppbXBvcnQgeyB1c2VBcHBTdG9yZVdpdGhPdXQgfSBmcm9tICJAL3N0b3JlL21vZHVsZXMvYXBwIjsKaW1wb3J0IGdldERhc2hib2FyZCBmcm9tICJAL2hvb2tzL3VzZURhc2hib2FyZHNTZXNzaW9uIjsKaW1wb3J0IHsgYWdncmVnYXRpb24gfSBmcm9tICJAL2hvb2tzL3VzZVByb2Nlc3NvciI7CmltcG9ydCBpY29ucyBmcm9tICJAL2Fzc2V0cy9pbWcvaWNvbnMiOwppbXBvcnQgeyB1c2VRdWVyeVRvcG9sb2d5TWV0cmljcyB9IGZyb20gIkAvaG9va3MvdXNlUHJvY2Vzc29yIjsKLypnbG9iYWwgTnVsbGFibGUsIGRlZmluZVByb3BzICovCgpleHBvcnQgZGVmYXVsdCAvKiNfX1BVUkVfXyovX2RlZmluZUNvbXBvbmVudCh7CiAgcHJvcHM6IHsKICAgIGNvbmZpZzogewogICAgICB0eXBlOiBPYmplY3QsCiAgICAgIGRlZmF1bHQ6IGZ1bmN0aW9uIF9kZWZhdWx0KCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBncmFwaDoge30KICAgICAgICB9OwogICAgICB9CiAgICB9CiAgfSwKICBzZXR1cDogZnVuY3Rpb24gc2V0dXAoX19wcm9wcykgewogICAgdmFyIHByb3BzID0gX19wcm9wczsKCiAgICB2YXIgX3VzZUkxOG4gPSB1c2VJMThuKCksCiAgICAgICAgdCA9IF91c2VJMThuLnQ7CgogICAgdmFyIHNlbGVjdG9yU3RvcmUgPSB1c2VTZWxlY3RvclN0b3JlKCk7CiAgICB2YXIgdG9wb2xvZ3lTdG9yZSA9IHVzZVRvcG9sb2d5U3RvcmUoKTsKICAgIHZhciBkYXNoYm9hcmRTdG9yZSA9IHVzZURhc2hib2FyZFN0b3JlKCk7CiAgICB2YXIgYXBwU3RvcmUgPSB1c2VBcHBTdG9yZVdpdGhPdXQoKTsKICAgIHZhciBoZWlnaHQgPSByZWYoMTAwKTsKICAgIHZhciB3aWR0aCA9IHJlZigxMDApOwogICAgdmFyIGxvYWRpbmcgPSByZWYoZmFsc2UpOwogICAgdmFyIHNpbXVsYXRpb24gPSByZWYobnVsbCk7CiAgICB2YXIgc3ZnID0gcmVmKG51bGwpOwogICAgdmFyIGNoYXJ0ID0gcmVmKG51bGwpOwogICAgdmFyIHRpcCA9IHJlZihudWxsKTsKICAgIHZhciBncmFwaCA9IHJlZihudWxsKTsKICAgIHZhciBub2RlID0gcmVmKG51bGwpOwogICAgdmFyIGxpbmsgPSByZWYobnVsbCk7CiAgICB2YXIgYW5jaG9yID0gcmVmKG51bGwpOwogICAgdmFyIGFycm93ID0gcmVmKG51bGwpOwogICAgdmFyIHNob3dTZXR0aW5nID0gcmVmKGZhbHNlKTsKICAgIHZhciBzZXR0aW5ncyA9IHJlZihwcm9wcy5jb25maWcpOwogICAgdmFyIG9wZXJhdGlvbnNQb3MgPSByZWFjdGl2ZSh7CiAgICAgIHg6IE5hTiwKICAgICAgeTogTmFOCiAgICB9KTsKICAgIHZhciBpdGVtcyA9IHJlZihbXSk7CiAgICB2YXIgZ3JhcGhDb25maWcgPSBjb21wdXRlZChmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBwcm9wcy5jb25maWcuZ3JhcGggfHwge307CiAgICB9KTsKICAgIHZhciBkZXB0aCA9IHJlZihncmFwaENvbmZpZy52YWx1ZS5kZXB0aCB8fCAyKTsKICAgIG9uTW91bnRlZCggLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgdmFyIF9kb2N1bWVudCRxdWVyeVNlbGVjdDsKCiAgICAgIHZhciBqc29uLCByZXNwLCBkb207CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBsb2FkaW5nLnZhbHVlID0gdHJ1ZTsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzsKICAgICAgICAgICAgICByZXR1cm4gc2VsZWN0b3JTdG9yZS5mZXRjaFNlcnZpY2VzKGRhc2hib2FyZFN0b3JlLmxheWVySWQpOwoKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIGpzb24gPSBfY29udGV4dC5zZW50OwoKICAgICAgICAgICAgICBpZiAoIWpzb24uZXJyb3JzKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNzsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgRWxNZXNzYWdlLmVycm9yKGpzb24uZXJyb3JzKTsKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gOTsKICAgICAgICAgICAgICByZXR1cm4gZ2V0VG9wb2xvZ3koKTsKCiAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICByZXNwID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICBsb2FkaW5nLnZhbHVlID0gZmFsc2U7CgogICAgICAgICAgICAgIGlmIChyZXNwICYmIHJlc3AuZXJyb3JzKSB7CiAgICAgICAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IocmVzcC5lcnJvcnMpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdG9wb2xvZ3lTdG9yZS5nZXRMaW5rQ2xpZW50TWV0cmljcyhzZXR0aW5ncy52YWx1ZS5saW5rQ2xpZW50TWV0cmljcyB8fCBbXSk7CiAgICAgICAgICAgICAgdG9wb2xvZ3lTdG9yZS5nZXRMaW5rU2VydmVyTWV0cmljcyhzZXR0aW5ncy52YWx1ZS5saW5rU2VydmVyTWV0cmljcyB8fCBbXSk7CiAgICAgICAgICAgICAgdG9wb2xvZ3lTdG9yZS5xdWVyeU5vZGVNZXRyaWNzKHNldHRpbmdzLnZhbHVlLm5vZGVNZXRyaWNzIHx8IFtdKTsKICAgICAgICAgICAgICBkb20gPSAoKF9kb2N1bWVudCRxdWVyeVNlbGVjdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi50b3BvbG9neSIpKSA9PT0gbnVsbCB8fCBfZG9jdW1lbnQkcXVlcnlTZWxlY3QgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9kb2N1bWVudCRxdWVyeVNlbGVjdC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSkgfHwgewogICAgICAgICAgICAgICAgaGVpZ2h0OiA0MCwKICAgICAgICAgICAgICAgIHdpZHRoOiAwCiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICBoZWlnaHQudmFsdWUgPSBkb20uaGVpZ2h0IC0gNDA7CiAgICAgICAgICAgICAgd2lkdGgudmFsdWUgPSBkb20ud2lkdGg7CiAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInJlc2l6ZSIsIHJlc2l6ZSk7CiAgICAgICAgICAgICAgc3ZnLnZhbHVlID0gZDMuc2VsZWN0KGNoYXJ0LnZhbHVlKS5hcHBlbmQoInN2ZyIpLmF0dHIoImNsYXNzIiwgInRvcG8tc3ZnIik7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDIyOwogICAgICAgICAgICAgIHJldHVybiBpbml0TGVnZW5kTWV0cmljcygpOwoKICAgICAgICAgICAgY2FzZSAyMjoKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjQ7CiAgICAgICAgICAgICAgcmV0dXJuIGluaXQoKTsKCiAgICAgICAgICAgIGNhc2UgMjQ6CiAgICAgICAgICAgICAgdXBkYXRlKCk7CiAgICAgICAgICAgICAgc2V0Tm9kZVRvb2xzKHNldHRpbmdzLnZhbHVlLm5vZGVEYXNoYm9hcmQpOwoKICAgICAgICAgICAgY2FzZSAyNjoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZSk7CiAgICB9KSkpOwoKICAgIGZ1bmN0aW9uIGluaXQoKSB7CiAgICAgIHJldHVybiBfaW5pdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgfQoKICAgIGZ1bmN0aW9uIF9pbml0KCkgewogICAgICBfaW5pdCA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHRpcC52YWx1ZSA9IGQzdGlwKCkuYXR0cigiY2xhc3MiLCAiZDMtdGlwIikub2Zmc2V0KFstOCwgMF0pOwogICAgICAgICAgICAgICAgZ3JhcGgudmFsdWUgPSBzdmcudmFsdWUuYXBwZW5kKCJnIikuYXR0cigiY2xhc3MiLCAidG9wby1zdmctZ3JhcGgiKS5hdHRyKCJ0cmFuc2Zvcm0iLCAidHJhbnNsYXRlKC0xMDAsIC0xMDApIik7CiAgICAgICAgICAgICAgICBncmFwaC52YWx1ZS5jYWxsKHRpcC52YWx1ZSk7CiAgICAgICAgICAgICAgICBzaW11bGF0aW9uLnZhbHVlID0gc2ltdWxhdGlvbkluaXQoZDMsIHRvcG9sb2d5U3RvcmUubm9kZXMsIHRvcG9sb2d5U3RvcmUuY2FsbHMsIHRpY2tlZCk7CiAgICAgICAgICAgICAgICBub2RlLnZhbHVlID0gZ3JhcGgudmFsdWUuYXBwZW5kKCJnIikuc2VsZWN0QWxsKCIudG9wby1ub2RlIik7CiAgICAgICAgICAgICAgICBsaW5rLnZhbHVlID0gZ3JhcGgudmFsdWUuYXBwZW5kKCJnIikuc2VsZWN0QWxsKCIudG9wby1saW5lIik7CiAgICAgICAgICAgICAgICBhbmNob3IudmFsdWUgPSBncmFwaC52YWx1ZS5hcHBlbmQoImciKS5zZWxlY3RBbGwoIi50b3BvLWxpbmUtYW5jaG9yIik7CiAgICAgICAgICAgICAgICBhcnJvdy52YWx1ZSA9IGdyYXBoLnZhbHVlLmFwcGVuZCgiZyIpLnNlbGVjdEFsbCgiLnRvcG8tbGluZS1hcnJvdyIpOwogICAgICAgICAgICAgICAgc3ZnLnZhbHVlLmNhbGwoem9vbShkMywgZ3JhcGgudmFsdWUsIFstMTAwLCAtMTAwXSkpOwogICAgICAgICAgICAgICAgc3ZnLnZhbHVlLm9uKCJjbGljayIsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgICAgICAgdG9wb2xvZ3lTdG9yZS5zZXROb2RlKG51bGwpOwogICAgICAgICAgICAgICAgICB0b3BvbG9neVN0b3JlLnNldExpbmsobnVsbCk7CiAgICAgICAgICAgICAgICAgIGRhc2hib2FyZFN0b3JlLnNlbGVjdFdpZGdldChwcm9wcy5jb25maWcpOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTIpOwogICAgICB9KSk7CiAgICAgIHJldHVybiBfaW5pdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgfQoKICAgIGZ1bmN0aW9uIGluaXRMZWdlbmRNZXRyaWNzKCkgewogICAgICByZXR1cm4gX2luaXRMZWdlbmRNZXRyaWNzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9CgogICAgZnVuY3Rpb24gX2luaXRMZWdlbmRNZXRyaWNzKCkgewogICAgICBfaW5pdExlZ2VuZE1ldHJpY3MgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkgewogICAgICAgIHZhciBpZHMsIG5hbWVzLCBwYXJhbSwgcmVzOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBpZHMgPSB0b3BvbG9neVN0b3JlLm5vZGVzLm1hcChmdW5jdGlvbiAoZCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gZC5pZDsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgbmFtZXMgPSBwcm9wcy5jb25maWcubGVnZW5kLm1hcChmdW5jdGlvbiAoZCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gZC5uYW1lOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgaWYgKCEobmFtZXMubGVuZ3RoICYmIGlkcy5sZW5ndGgpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gNTsKICAgICAgICAgICAgICAgIHJldHVybiB1c2VRdWVyeVRvcG9sb2d5TWV0cmljcyhuYW1lcywgaWRzKTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgcGFyYW0gPSBfY29udGV4dDMuc2VudDsKICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gODsKICAgICAgICAgICAgICAgIHJldHVybiB0b3BvbG9neVN0b3JlLmdldExlZ2VuZE1ldHJpY3MocGFyYW0pOwoKICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICByZXMgPSBfY29udGV4dDMuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAocmVzLmVycm9ycykgewogICAgICAgICAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IocmVzLmVycm9ycyk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTMpOwogICAgICB9KSk7CiAgICAgIHJldHVybiBfaW5pdExlZ2VuZE1ldHJpY3MuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH0KCiAgICBmdW5jdGlvbiB0aWNrZWQoKSB7CiAgICAgIGxpbmsudmFsdWUuYXR0cigiZCIsIGZ1bmN0aW9uIChkKSB7CiAgICAgICAgcmV0dXJuICJNIi5jb25jYXQoZC5zb3VyY2UueCwgIiAiKS5jb25jYXQoZC5zb3VyY2UueSwgIiBRICIpLmNvbmNhdCgoZC5zb3VyY2UueCArIGQudGFyZ2V0LngpIC8gMiwgIiAiKS5jb25jYXQoKGQudGFyZ2V0LnkgKyBkLnNvdXJjZS55KSAvIDIgLSBkLmxvb3BGYWN0b3IgKiA5MCwgIiAiKS5jb25jYXQoZC50YXJnZXQueCwgIiAiKS5jb25jYXQoZC50YXJnZXQueSk7CiAgICAgIH0pOwogICAgICBhbmNob3IudmFsdWUuYXR0cigidHJhbnNmb3JtIiwgZnVuY3Rpb24gKGQpIHsKICAgICAgICByZXR1cm4gInRyYW5zbGF0ZSgiLmNvbmNhdCgoZC5zb3VyY2UueCArIGQudGFyZ2V0LngpIC8gMiwgIiwgIikuY29uY2F0KChkLnRhcmdldC55ICsgZC5zb3VyY2UueSkgLyAyIC0gZC5sb29wRmFjdG9yICogNDUsICIpIik7CiAgICAgIH0pOwogICAgICBub2RlLnZhbHVlLmF0dHIoInRyYW5zZm9ybSIsIGZ1bmN0aW9uIChkKSB7CiAgICAgICAgcmV0dXJuICJ0cmFuc2xhdGUoIi5jb25jYXQoZC54IC0gMjIsICIsIikuY29uY2F0KGQueSAtIDIyLCAiKSIpOwogICAgICB9KTsKICAgIH0KCiAgICBmdW5jdGlvbiBkcmFnc3RhcnQoZCkgewogICAgICBub2RlLnZhbHVlLl9ncm91cHNbMF0uZm9yRWFjaChmdW5jdGlvbiAoZykgewogICAgICAgIGcuX19kYXRhX18uZnggPSBnLl9fZGF0YV9fLng7CiAgICAgICAgZy5fX2RhdGFfXy5meSA9IGcuX19kYXRhX18ueTsKICAgICAgfSk7CgogICAgICBpZiAoIWQuYWN0aXZlKSB7CiAgICAgICAgc2ltdWxhdGlvbi52YWx1ZS5hbHBoYVRhcmdldCgwLjEpLnJlc3RhcnQoKTsKICAgICAgfQoKICAgICAgZC5zdWJqZWN0LmZ4ID0gZC5zdWJqZWN0Lng7CiAgICAgIGQuc3ViamVjdC5meSA9IGQuc3ViamVjdC55OwogICAgICBkLnNvdXJjZUV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOwogICAgfQoKICAgIGZ1bmN0aW9uIGRyYWdnZWQoZCkgewogICAgICBkLnN1YmplY3QuZnggPSBkLng7CiAgICAgIGQuc3ViamVjdC5meSA9IGQueTsKICAgIH0KCiAgICBmdW5jdGlvbiBkcmFnZW5kZWQoZCkgewogICAgICBpZiAoIWQuYWN0aXZlKSB7CiAgICAgICAgc2ltdWxhdGlvbi52YWx1ZS5hbHBoYVRhcmdldCgwKTsKICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGhhbmRsZU5vZGVDbGljayhkKSB7CiAgICAgIHRvcG9sb2d5U3RvcmUuc2V0Tm9kZShkKTsKICAgICAgdG9wb2xvZ3lTdG9yZS5zZXRMaW5rKG51bGwpOwogICAgICBvcGVyYXRpb25zUG9zLnggPSBkLnggLSAxMDA7CiAgICAgIG9wZXJhdGlvbnNQb3MueSA9IGQueSAtIDcwOwoKICAgICAgaWYgKGQubGF5ZXIgPT09IFN0cmluZyhkYXNoYm9hcmRTdG9yZS5sYXllcklkKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaXRlbXMudmFsdWUgPSBbewogICAgICAgIGlkOiAiaW5zcGVjdCIsCiAgICAgICAgdGl0bGU6ICJJbnNwZWN0IiwKICAgICAgICBmdW5jOiBoYW5kbGVJbnNwZWN0CiAgICAgIH0sIHsKICAgICAgICBpZDogImFsYXJtIiwKICAgICAgICB0aXRsZTogIkFsYXJtIiwKICAgICAgICBmdW5jOiBoYW5kbGVHb0FsYXJtCiAgICAgIH1dOwogICAgfQoKICAgIGZ1bmN0aW9uIGhhbmRsZUxpbmtDbGljayhldmVudCwgZCkgewogICAgICBpZiAoZC5zb3VyY2UubGF5ZXIgIT09IGRhc2hib2FyZFN0b3JlLmxheWVySWQgfHwgZC50YXJnZXQubGF5ZXIgIT09IGRhc2hib2FyZFN0b3JlLmxheWVySWQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOwogICAgICB0b3BvbG9neVN0b3JlLnNldE5vZGUobnVsbCk7CiAgICAgIHRvcG9sb2d5U3RvcmUuc2V0TGluayhkKTsKCiAgICAgIGlmICghc2V0dGluZ3MudmFsdWUubGlua0Rhc2hib2FyZCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIG9yaWdpbiA9IGRhc2hib2FyZFN0b3JlLmVudGl0eTsKICAgICAgdmFyIGUgPSBkYXNoYm9hcmRTdG9yZS5lbnRpdHkgPT09IEVudGl0eVR5cGVbMV0udmFsdWUgPyBFbnRpdHlUeXBlWzBdLnZhbHVlIDogZGFzaGJvYXJkU3RvcmUuZW50aXR5OwoKICAgICAgdmFyIF9nZXREYXNoYm9hcmQgPSBnZXREYXNoYm9hcmQoewogICAgICAgIG5hbWU6IHNldHRpbmdzLnZhbHVlLmxpbmtEYXNoYm9hcmQsCiAgICAgICAgbGF5ZXI6IGRhc2hib2FyZFN0b3JlLmxheWVySWQsCiAgICAgICAgZW50aXR5OiAiIi5jb25jYXQoZSwgIlJlbGF0aW9uIikKICAgICAgfSksCiAgICAgICAgICBkYXNoYm9hcmQgPSBfZ2V0RGFzaGJvYXJkLmRhc2hib2FyZDsKCiAgICAgIGlmICghZGFzaGJvYXJkKSB7CiAgICAgICAgRWxNZXNzYWdlLmVycm9yKCJUaGUgZGFzaGJvYXJkIG5hbWVkICIuY29uY2F0KHNldHRpbmdzLnZhbHVlLmxpbmtEYXNoYm9hcmQsICIgZG9lc24ndCBleGlzdCIpKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGRhc2hib2FyZFN0b3JlLnNldEVudGl0eShkYXNoYm9hcmQuZW50aXR5KTsKICAgICAgdmFyIHBhdGggPSAiL2Rhc2hib2FyZC9yZWxhdGVkLyIuY29uY2F0KGRhc2hib2FyZC5sYXllciwgIi8iKS5jb25jYXQoZSwgIlJlbGF0aW9uLyIpLmNvbmNhdChkLnNvdXJjZS5pZCwgIi8iKS5jb25jYXQoZC50YXJnZXQuaWQsICIvIikuY29uY2F0KGRhc2hib2FyZC5uYW1lKTsKICAgICAgdmFyIHJvdXRlVXJsID0gcm91dGVyLnJlc29sdmUoewogICAgICAgIHBhdGg6IHBhdGgKICAgICAgfSk7CiAgICAgIHdpbmRvdy5vcGVuKHJvdXRlVXJsLmhyZWYsICJfYmxhbmsiKTsKICAgICAgZGFzaGJvYXJkU3RvcmUuc2V0RW50aXR5KG9yaWdpbik7CiAgICB9CgogICAgZnVuY3Rpb24gdXBkYXRlKCkgewogICAgICAvLyBub2RlIGVsZW1lbnQKICAgICAgaWYgKCFub2RlLnZhbHVlIHx8ICFsaW5rLnZhbHVlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBub2RlLnZhbHVlID0gbm9kZS52YWx1ZS5kYXRhKHRvcG9sb2d5U3RvcmUubm9kZXMsIGZ1bmN0aW9uIChkKSB7CiAgICAgICAgcmV0dXJuIGQuaWQ7CiAgICAgIH0pOwogICAgICBub2RlLnZhbHVlLmV4aXQoKS5yZW1vdmUoKTsKICAgICAgbm9kZS52YWx1ZSA9IG5vZGVFbGVtZW50KGQzLCBub2RlLnZhbHVlLmVudGVyKCksIHsKICAgICAgICBkcmFnc3RhcnQ6IGRyYWdzdGFydCwKICAgICAgICBkcmFnZ2VkOiBkcmFnZ2VkLAogICAgICAgIGRyYWdlbmRlZDogZHJhZ2VuZGVkLAogICAgICAgIGhhbmRsZU5vZGVDbGljazogaGFuZGxlTm9kZUNsaWNrLAogICAgICAgIHRpcEh0bWw6IGZ1bmN0aW9uIHRpcEh0bWwoZGF0YSkgewogICAgICAgICAgdmFyIG5vZGVNZXRyaWNzID0gc2V0dGluZ3MudmFsdWUubm9kZU1ldHJpY3MgfHwgW107CiAgICAgICAgICB2YXIgbm9kZU1ldHJpY0NvbmZpZyA9IHNldHRpbmdzLnZhbHVlLm5vZGVNZXRyaWNDb25maWcgfHwgW107CiAgICAgICAgICB2YXIgaHRtbCA9IG5vZGVNZXRyaWNzLm1hcChmdW5jdGlvbiAobSwgaW5kZXgpIHsKICAgICAgICAgICAgdmFyIG1ldHJpYyA9IHRvcG9sb2d5U3RvcmUubm9kZU1ldHJpY1ZhbHVlW21dLnZhbHVlcy5maW5kKGZ1bmN0aW9uICh2YWwpIHsKICAgICAgICAgICAgICByZXR1cm4gdmFsLmlkID09PSBkYXRhLmlkOwogICAgICAgICAgICB9KSB8fCB7fTsKICAgICAgICAgICAgdmFyIG9wdCA9IG5vZGVNZXRyaWNDb25maWdbaW5kZXhdIHx8IHt9OwogICAgICAgICAgICB2YXIgdiA9IGFnZ3JlZ2F0aW9uKG1ldHJpYy52YWx1ZSwgb3B0KTsKICAgICAgICAgICAgcmV0dXJuICIgPGRpdiBjbGFzcz1cIm1iLTVcIj48c3BhbiBjbGFzcz1cImdyZXlcIj4iLmNvbmNhdChvcHQubGFiZWwgfHwgbSwgIjogPC9zcGFuPiIpLmNvbmNhdCh2LCAiICIpLmNvbmNhdChvcHQudW5pdCB8fCAiIiwgIjwvZGl2PiIpOwogICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm4gWyIgPGRpdiBjbGFzcz1cIm1iLTVcIj48c3BhbiBjbGFzcz1cImdyZXlcIj5uYW1lOiA8L3NwYW4+Ii5jb25jYXQoZGF0YS5uYW1lLCAiPC9kaXY+IildLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoaHRtbCkpLmpvaW4oIiAiKTsKICAgICAgICB9CiAgICAgIH0sIHRpcC52YWx1ZSwgc2V0dGluZ3MudmFsdWUubGVnZW5kKS5tZXJnZShub2RlLnZhbHVlKTsgLy8gbGluZSBlbGVtZW50CgogICAgICBsaW5rLnZhbHVlID0gbGluay52YWx1ZS5kYXRhKHRvcG9sb2d5U3RvcmUuY2FsbHMsIGZ1bmN0aW9uIChkKSB7CiAgICAgICAgcmV0dXJuIGQuaWQ7CiAgICAgIH0pOwogICAgICBsaW5rLnZhbHVlLmV4aXQoKS5yZW1vdmUoKTsKICAgICAgbGluay52YWx1ZSA9IGxpbmtFbGVtZW50KGxpbmsudmFsdWUuZW50ZXIoKSkubWVyZ2UobGluay52YWx1ZSk7IC8vIGFuY2hvckVsZW1lbnQKCiAgICAgIGFuY2hvci52YWx1ZSA9IGFuY2hvci52YWx1ZS5kYXRhKHRvcG9sb2d5U3RvcmUuY2FsbHMsIGZ1bmN0aW9uIChkKSB7CiAgICAgICAgcmV0dXJuIGQuaWQ7CiAgICAgIH0pOwogICAgICBhbmNob3IudmFsdWUuZXhpdCgpLnJlbW92ZSgpOwogICAgICBhbmNob3IudmFsdWUgPSBhbmNob3JFbGVtZW50KGFuY2hvci52YWx1ZS5lbnRlcigpLCB7CiAgICAgICAgaGFuZGxlTGlua0NsaWNrOiBoYW5kbGVMaW5rQ2xpY2ssCiAgICAgICAgdGlwSHRtbDogZnVuY3Rpb24gdGlwSHRtbChkYXRhKSB7CiAgICAgICAgICB2YXIgbGlua0NsaWVudE1ldHJpY3MgPSBzZXR0aW5ncy52YWx1ZS5saW5rQ2xpZW50TWV0cmljcyB8fCBbXTsKICAgICAgICAgIHZhciBsaW5rU2VydmVyTWV0cmljQ29uZmlnID0gc2V0dGluZ3MudmFsdWUubGlua1NlcnZlck1ldHJpY0NvbmZpZyB8fCBbXTsKICAgICAgICAgIHZhciBsaW5rQ2xpZW50TWV0cmljQ29uZmlnID0gc2V0dGluZ3MudmFsdWUubGlua0NsaWVudE1ldHJpY0NvbmZpZyB8fCBbXTsKICAgICAgICAgIHZhciBsaW5rU2VydmVyTWV0cmljcyA9IHNldHRpbmdzLnZhbHVlLmxpbmtTZXJ2ZXJNZXRyaWNzIHx8IFtdOwogICAgICAgICAgdmFyIGh0bWxTZXJ2ZXIgPSBsaW5rU2VydmVyTWV0cmljcy5tYXAoZnVuY3Rpb24gKG0sIGluZGV4KSB7CiAgICAgICAgICAgIHZhciBtZXRyaWMgPSB0b3BvbG9neVN0b3JlLmxpbmtTZXJ2ZXJNZXRyaWNzW21dLnZhbHVlcy5maW5kKGZ1bmN0aW9uICh2YWwpIHsKICAgICAgICAgICAgICByZXR1cm4gdmFsLmlkID09PSBkYXRhLmlkOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGlmIChtZXRyaWMpIHsKICAgICAgICAgICAgICB2YXIgb3B0ID0gbGlua1NlcnZlck1ldHJpY0NvbmZpZ1tpbmRleF0gfHwge307CiAgICAgICAgICAgICAgdmFyIHYgPSBhZ2dyZWdhdGlvbihtZXRyaWMudmFsdWUsIG9wdCk7CiAgICAgICAgICAgICAgcmV0dXJuICIgPGRpdiBjbGFzcz1cIm1iLTVcIj48c3BhbiBjbGFzcz1cImdyZXlcIj4iLmNvbmNhdChvcHQubGFiZWwgfHwgbSwgIjogPC9zcGFuPiIpLmNvbmNhdCh2LCAiICIpLmNvbmNhdChvcHQudW5pdCB8fCAiIiwgIjwvZGl2PiIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAgIHZhciBodG1sQ2xpZW50ID0gbGlua0NsaWVudE1ldHJpY3MubWFwKGZ1bmN0aW9uIChtLCBpbmRleCkgewogICAgICAgICAgICB2YXIgb3B0ID0gbGlua0NsaWVudE1ldHJpY0NvbmZpZ1tpbmRleF0gfHwge307CiAgICAgICAgICAgIHZhciBtZXRyaWMgPSB0b3BvbG9neVN0b3JlLmxpbmtDbGllbnRNZXRyaWNzW21dLnZhbHVlcy5maW5kKGZ1bmN0aW9uICh2YWwpIHsKICAgICAgICAgICAgICByZXR1cm4gdmFsLmlkID09PSBkYXRhLmlkOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGlmIChtZXRyaWMpIHsKICAgICAgICAgICAgICB2YXIgdiA9IGFnZ3JlZ2F0aW9uKG1ldHJpYy52YWx1ZSwgb3B0KTsKICAgICAgICAgICAgICByZXR1cm4gIiA8ZGl2IGNsYXNzPVwibWItNVwiPjxzcGFuIGNsYXNzPVwiZ3JleVwiPiIuY29uY2F0KG9wdC5sYWJlbCB8fCBtLCAiOiA8L3NwYW4+IikuY29uY2F0KHYsICIgIikuY29uY2F0KG9wdC51bml0IHx8ICIiLCAiPC9kaXY+Iik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgICAgdmFyIGh0bWwgPSBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KGh0bWxTZXJ2ZXIpLCBfdG9Db25zdW1hYmxlQXJyYXkoaHRtbENsaWVudCksIFsiPGRpdj48c3BhbiBjbGFzcz1cImdyZXlcIj4iLmNvbmNhdCh0KCJkZXRlY3RQb2ludCIpLCAiOjwvc3Bhbj4iKS5jb25jYXQoZGF0YS5kZXRlY3RQb2ludHMuam9pbigiIHwgIiksICI8L2Rpdj4iKV0pLmpvaW4oIiAiKTsKICAgICAgICAgIHJldHVybiBodG1sOwogICAgICAgIH0KICAgICAgfSwgdGlwLnZhbHVlKS5tZXJnZShhbmNob3IudmFsdWUpOyAvLyBhcnJvdyBtYXJrZXIKCiAgICAgIGFycm93LnZhbHVlID0gYXJyb3cudmFsdWUuZGF0YSh0b3BvbG9neVN0b3JlLmNhbGxzLCBmdW5jdGlvbiAoZCkgewogICAgICAgIHJldHVybiBkLmlkOwogICAgICB9KTsKICAgICAgYXJyb3cudmFsdWUuZXhpdCgpLnJlbW92ZSgpOwogICAgICBhcnJvdy52YWx1ZSA9IGFycm93TWFya2VyKGFycm93LnZhbHVlLmVudGVyKCkpLm1lcmdlKGFycm93LnZhbHVlKTsgLy8gZm9yY2UgZWxlbWVudAoKICAgICAgc2ltdWxhdGlvbi52YWx1ZS5ub2Rlcyh0b3BvbG9neVN0b3JlLm5vZGVzKTsKICAgICAgc2ltdWxhdGlvbi52YWx1ZS5mb3JjZSgibGluayIpLmxpbmtzKHRvcG9sb2d5U3RvcmUuY2FsbHMpLmlkKGZ1bmN0aW9uIChkKSB7CiAgICAgICAgcmV0dXJuIGQuaWQ7CiAgICAgIH0pOwogICAgICBzaW11bGF0aW9uU2tpcChkMywgc2ltdWxhdGlvbi52YWx1ZSwgdGlja2VkKTsKICAgICAgdmFyIGxvb3BNYXAgPSB7fTsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdG9wb2xvZ3lTdG9yZS5jYWxscy5sZW5ndGg7IGkrKykgewogICAgICAgIHZhciBfbGluayA9IHRvcG9sb2d5U3RvcmUuY2FsbHNbaV07CiAgICAgICAgX2xpbmsubG9vcEZhY3RvciA9IDE7CgogICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdG9wb2xvZ3lTdG9yZS5jYWxscy5sZW5ndGg7IGorKykgewogICAgICAgICAgaWYgKGkgPT09IGogfHwgbG9vcE1hcFtpXSkgewogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgb3RoZXJMaW5rID0gdG9wb2xvZ3lTdG9yZS5jYWxsc1tqXTsKCiAgICAgICAgICBpZiAoX2xpbmsuc291cmNlLmlkID09PSBvdGhlckxpbmsudGFyZ2V0LmlkICYmIF9saW5rLnRhcmdldC5pZCA9PT0gb3RoZXJMaW5rLnNvdXJjZS5pZCkgewogICAgICAgICAgICBfbGluay5sb29wRmFjdG9yID0gLTE7CiAgICAgICAgICAgIGxvb3BNYXBbal0gPSAxOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBoYW5kbGVJbnNwZWN0KCkgewogICAgICByZXR1cm4gX2hhbmRsZUluc3BlY3QuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH0KCiAgICBmdW5jdGlvbiBfaGFuZGxlSW5zcGVjdCgpIHsKICAgICAgX2hhbmRsZUluc3BlY3QgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KCkgewogICAgICAgIHZhciBpZCwgcmVzcDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQkKF9jb250ZXh0NCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgc3ZnLnZhbHVlLnNlbGVjdEFsbCgiLnRvcG8tc3ZnLWdyYXBoIikucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICBpZCA9IHRvcG9sb2d5U3RvcmUubm9kZS5pZDsKICAgICAgICAgICAgICAgIHRvcG9sb2d5U3RvcmUuc2V0Tm9kZShudWxsKTsKICAgICAgICAgICAgICAgIHRvcG9sb2d5U3RvcmUuc2V0TGluayhudWxsKTsKICAgICAgICAgICAgICAgIGxvYWRpbmcudmFsdWUgPSB0cnVlOwogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSA3OwogICAgICAgICAgICAgICAgcmV0dXJuIHRvcG9sb2d5U3RvcmUuZ2V0RGVwdGhTZXJ2aWNlVG9wb2xvZ3koW2lkXSwgTnVtYmVyKGRlcHRoLnZhbHVlKSk7CgogICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgIHJlc3AgPSBfY29udGV4dDQuc2VudDsKICAgICAgICAgICAgICAgIGxvYWRpbmcudmFsdWUgPSBmYWxzZTsKCiAgICAgICAgICAgICAgICBpZiAocmVzcCAmJiByZXNwLmVycm9ycykgewogICAgICAgICAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IocmVzcC5lcnJvcnMpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMTI7CiAgICAgICAgICAgICAgICByZXR1cm4gaW5pdCgpOwoKICAgICAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICAgICAgdXBkYXRlKCk7CgogICAgICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTQpOwogICAgICB9KSk7CiAgICAgIHJldHVybiBfaGFuZGxlSW5zcGVjdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgfQoKICAgIGZ1bmN0aW9uIGhhbmRsZUdvRW5kcG9pbnQobmFtZSkgewogICAgICB2YXIgcGF0aCA9ICIvZGFzaGJvYXJkLyIuY29uY2F0KGRhc2hib2FyZFN0b3JlLmxheWVySWQsICIvIikuY29uY2F0KEVudGl0eVR5cGVbMl0udmFsdWUsICIvIikuY29uY2F0KHRvcG9sb2d5U3RvcmUubm9kZS5pZCwgIi8iKS5jb25jYXQobmFtZSk7CiAgICAgIHZhciByb3V0ZVVybCA9IHJvdXRlci5yZXNvbHZlKHsKICAgICAgICBwYXRoOiBwYXRoCiAgICAgIH0pOwogICAgICB3aW5kb3cub3Blbihyb3V0ZVVybC5ocmVmLCAiX2JsYW5rIik7CiAgICAgIGRhc2hib2FyZFN0b3JlLnNldEVudGl0eShvcmlnaW4pOwogICAgfQoKICAgIGZ1bmN0aW9uIGhhbmRsZUdvSW5zdGFuY2UobmFtZSkgewogICAgICB2YXIgcGF0aCA9ICIvZGFzaGJvYXJkLyIuY29uY2F0KGRhc2hib2FyZFN0b3JlLmxheWVySWQsICIvIikuY29uY2F0KEVudGl0eVR5cGVbM10udmFsdWUsICIvIikuY29uY2F0KHRvcG9sb2d5U3RvcmUubm9kZS5pZCwgIi8iKS5jb25jYXQobmFtZSk7CiAgICAgIHZhciByb3V0ZVVybCA9IHJvdXRlci5yZXNvbHZlKHsKICAgICAgICBwYXRoOiBwYXRoCiAgICAgIH0pOwogICAgICB3aW5kb3cub3Blbihyb3V0ZVVybC5ocmVmLCAiX2JsYW5rIik7CiAgICAgIGRhc2hib2FyZFN0b3JlLnNldEVudGl0eShvcmlnaW4pOwogICAgfQoKICAgIGZ1bmN0aW9uIGhhbmRsZUdvRGFzaGJvYXJkKG5hbWUpIHsKICAgICAgdmFyIHBhdGggPSAiL2Rhc2hib2FyZC8iLmNvbmNhdChkYXNoYm9hcmRTdG9yZS5sYXllcklkLCAiLyIpLmNvbmNhdChFbnRpdHlUeXBlWzBdLnZhbHVlLCAiLyIpLmNvbmNhdCh0b3BvbG9neVN0b3JlLm5vZGUuaWQsICIvIikuY29uY2F0KG5hbWUpOwogICAgICB2YXIgcm91dGVVcmwgPSByb3V0ZXIucmVzb2x2ZSh7CiAgICAgICAgcGF0aDogcGF0aAogICAgICB9KTsKICAgICAgd2luZG93Lm9wZW4ocm91dGVVcmwuaHJlZiwgIl9ibGFuayIpOwogICAgICBkYXNoYm9hcmRTdG9yZS5zZXRFbnRpdHkob3JpZ2luKTsKICAgIH0KCiAgICBmdW5jdGlvbiBoYW5kbGVHb0FsYXJtKCkgewogICAgICB2YXIgcGF0aCA9ICIvYWxhcm0iOwogICAgICB2YXIgcm91dGVVcmwgPSByb3V0ZXIucmVzb2x2ZSh7CiAgICAgICAgcGF0aDogcGF0aAogICAgICB9KTsKICAgICAgd2luZG93Lm9wZW4ocm91dGVVcmwuaHJlZiwgIl9ibGFuayIpOwogICAgfQoKICAgIGZ1bmN0aW9uIGJhY2tUb1RvcG9sb2d5KCkgewogICAgICByZXR1cm4gX2JhY2tUb1RvcG9sb2d5LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9CgogICAgZnVuY3Rpb24gX2JhY2tUb1RvcG9sb2d5KCkgewogICAgICBfYmFja1RvVG9wb2xvZ3kgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1KCkgewogICAgICAgIHZhciByZXNwOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNSQoX2NvbnRleHQ1KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBzdmcudmFsdWUuc2VsZWN0QWxsKCIudG9wby1zdmctZ3JhcGgiKS5yZW1vdmUoKTsKICAgICAgICAgICAgICAgIGxvYWRpbmcudmFsdWUgPSB0cnVlOwogICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSA0OwogICAgICAgICAgICAgICAgcmV0dXJuIGdldFRvcG9sb2d5KCk7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgIHJlc3AgPSBfY29udGV4dDUuc2VudDsKICAgICAgICAgICAgICAgIGxvYWRpbmcudmFsdWUgPSBmYWxzZTsKCiAgICAgICAgICAgICAgICBpZiAocmVzcCAmJiByZXNwLmVycm9ycykgewogICAgICAgICAgICAgICAgICBFbE1lc3NhZ2UuZXJyb3IocmVzcC5lcnJvcnMpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gOTsKICAgICAgICAgICAgICAgIHJldHVybiBpbml0KCk7CgogICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICAgIHVwZGF0ZSgpOwogICAgICAgICAgICAgICAgdG9wb2xvZ3lTdG9yZS5zZXROb2RlKG51bGwpOwogICAgICAgICAgICAgICAgdG9wb2xvZ3lTdG9yZS5zZXRMaW5rKG51bGwpOwoKICAgICAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU1KTsKICAgICAgfSkpOwogICAgICByZXR1cm4gX2JhY2tUb1RvcG9sb2d5LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0VG9wb2xvZ3koKSB7CiAgICAgIHJldHVybiBfZ2V0VG9wb2xvZ3kuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH0KCiAgICBmdW5jdGlvbiBfZ2V0VG9wb2xvZ3koKSB7CiAgICAgIF9nZXRUb3BvbG9neSA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTYoKSB7CiAgICAgICAgdmFyIGlkcywgc2VydmljZUlkcywgcmVzcDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTYkKF9jb250ZXh0NikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDYucHJldiA9IF9jb250ZXh0Ni5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgaWRzID0gc2VsZWN0b3JTdG9yZS5zZXJ2aWNlcy5tYXAoZnVuY3Rpb24gKGQpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuaWQ7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHNlcnZpY2VJZHMgPSBkYXNoYm9hcmRTdG9yZS5lbnRpdHkgPT09IEVudGl0eVR5cGVbMF0udmFsdWUgPyBbc2VsZWN0b3JTdG9yZS5jdXJyZW50U2VydmljZS5pZF0gOiBpZHM7CiAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICByZXR1cm4gdG9wb2xvZ3lTdG9yZS5nZXREZXB0aFNlcnZpY2VUb3BvbG9neShzZXJ2aWNlSWRzLCBOdW1iZXIoZGVwdGgudmFsdWUpKTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgcmVzcCA9IF9jb250ZXh0Ni5zZW50OwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5hYnJ1cHQoInJldHVybiIsIHJlc3ApOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTYpOwogICAgICB9KSk7CiAgICAgIHJldHVybiBfZ2V0VG9wb2xvZ3kuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRDb25maWcoKSB7CiAgICAgIHNob3dTZXR0aW5nLnZhbHVlID0gIXNob3dTZXR0aW5nLnZhbHVlOwogICAgICBkYXNoYm9hcmRTdG9yZS5zZWxlY3RXaWRnZXQocHJvcHMuY29uZmlnKTsKICAgIH0KCiAgICBmdW5jdGlvbiByZXNpemUoKSB7CiAgICAgIHZhciBfZG9jdW1lbnQkcXVlcnlTZWxlY3QyOwoKICAgICAgdmFyIGRvbSA9ICgoX2RvY3VtZW50JHF1ZXJ5U2VsZWN0MiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi50b3BvbG9neSIpKSA9PT0gbnVsbCB8fCBfZG9jdW1lbnQkcXVlcnlTZWxlY3QyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZG9jdW1lbnQkcXVlcnlTZWxlY3QyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpKSB8fCB7CiAgICAgICAgaGVpZ2h0OiA0MCwKICAgICAgICB3aWR0aDogMAogICAgICB9OwogICAgICBoZWlnaHQudmFsdWUgPSBkb20uaGVpZ2h0IC0gNDA7CiAgICAgIHdpZHRoLnZhbHVlID0gZG9tLndpZHRoOwogICAgICBzdmcudmFsdWUuYXR0cigiaGVpZ2h0IiwgaGVpZ2h0LnZhbHVlKS5hdHRyKCJ3aWR0aCIsIHdpZHRoLnZhbHVlKTsKICAgIH0KCiAgICBmdW5jdGlvbiB1cGRhdGVTZXR0aW5ncyhjb25maWcpIHsKICAgICAgc2V0dGluZ3MudmFsdWUgPSBjb25maWc7CiAgICAgIHNldE5vZGVUb29scyhjb25maWcubm9kZURhc2hib2FyZCk7CiAgICB9CgogICAgZnVuY3Rpb24gc2V0Tm9kZVRvb2xzKG5vZGVEYXNoYm9hcmQpIHsKICAgICAgaXRlbXMudmFsdWUgPSBbewogICAgICAgIGlkOiAiaW5zcGVjdCIsCiAgICAgICAgdGl0bGU6ICJJbnNwZWN0IiwKICAgICAgICBmdW5jOiBoYW5kbGVJbnNwZWN0CiAgICAgIH0sIHsKICAgICAgICBpZDogImFsYXJtIiwKICAgICAgICB0aXRsZTogIkFsYXJtIiwKICAgICAgICBmdW5jOiBoYW5kbGVHb0FsYXJtCiAgICAgIH1dOwoKICAgICAgaWYgKCEobm9kZURhc2hib2FyZCAmJiBub2RlRGFzaGJvYXJkLmxlbmd0aCkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBfaXRlcmF0b3IgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihub2RlRGFzaGJvYXJkKSwKICAgICAgICAgIF9zdGVwOwoKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKF9pdGVyYXRvci5zKCk7ICEoX3N0ZXAgPSBfaXRlcmF0b3IubigpKS5kb25lOykgewogICAgICAgICAgdmFyIGl0ZW0gPSBfc3RlcC52YWx1ZTsKCiAgICAgICAgICBpZiAoaXRlbS5zY29wZSA9PT0gRW50aXR5VHlwZVswXS52YWx1ZSkgewogICAgICAgICAgICBpdGVtcy52YWx1ZS5wdXNoKF9vYmplY3RTcHJlYWQoewogICAgICAgICAgICAgIGlkOiAiZGFzaGJvYXJkIiwKICAgICAgICAgICAgICB0aXRsZTogIlNlcnZpY2UgRGFzaGJvYXJkIiwKICAgICAgICAgICAgICBmdW5jOiBoYW5kbGVHb0Rhc2hib2FyZAogICAgICAgICAgICB9LCBpdGVtKSk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGl0ZW0uc2NvcGUgPT09IEVudGl0eVR5cGVbMl0udmFsdWUpIHsKICAgICAgICAgICAgaXRlbXMudmFsdWUucHVzaChfb2JqZWN0U3ByZWFkKHsKICAgICAgICAgICAgICBpZDogImVuZHBvaW50IiwKICAgICAgICAgICAgICB0aXRsZTogIkVuZHBvaW50IERhc2hib2FyZCIsCiAgICAgICAgICAgICAgZnVuYzogaGFuZGxlR29FbmRwb2ludAogICAgICAgICAgICB9LCBpdGVtKSk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGl0ZW0uc2NvcGUgPT09IEVudGl0eVR5cGVbM10udmFsdWUpIHsKICAgICAgICAgICAgaXRlbXMudmFsdWUucHVzaChfb2JqZWN0U3ByZWFkKHsKICAgICAgICAgICAgICBpZDogImluc3RhbmNlIiwKICAgICAgICAgICAgICB0aXRsZTogIlNlcnZpY2UgSW5zdGFuY2UgRGFzaGJvYXJkIiwKICAgICAgICAgICAgICBmdW5jOiBoYW5kbGVHb0luc3RhbmNlCiAgICAgICAgICAgIH0sIGl0ZW0pKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIF9pdGVyYXRvci5lKGVycik7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgX2l0ZXJhdG9yLmYoKTsKICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGZyZXNoTm9kZXMoKSB7CiAgICAgIHJldHVybiBfZnJlc2hOb2Rlcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgfQoKICAgIGZ1bmN0aW9uIF9mcmVzaE5vZGVzKCkgewogICAgICBfZnJlc2hOb2RlcyA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTcoKSB7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU3JChfY29udGV4dDcpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ3LnByZXYgPSBfY29udGV4dDcubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGlmIChzdmcudmFsdWUpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIHN2Zy52YWx1ZS5zZWxlY3RBbGwoIi50b3BvLXN2Zy1ncmFwaCIpLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSA1OwogICAgICAgICAgICAgICAgcmV0dXJuIGluaXQoKTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgdXBkYXRlKCk7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNyk7CiAgICAgIH0pKTsKICAgICAgcmV0dXJuIF9mcmVzaE5vZGVzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9CgogICAgZnVuY3Rpb24gY2hhbmdlRGVwdGgoX3gpIHsKICAgICAgcmV0dXJuIF9jaGFuZ2VEZXB0aC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgfQoKICAgIGZ1bmN0aW9uIF9jaGFuZ2VEZXB0aCgpIHsKICAgICAgX2NoYW5nZURlcHRoID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlOChvcHQpIHsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTgkKF9jb250ZXh0OCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDgucHJldiA9IF9jb250ZXh0OC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgZGVwdGgudmFsdWUgPSBvcHRbMF0udmFsdWU7CiAgICAgICAgICAgICAgICBfY29udGV4dDgubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0VG9wb2xvZ3koKTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgZnJlc2hOb2RlcygpOwoKICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDguc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTgpOwogICAgICB9KSk7CiAgICAgIHJldHVybiBfY2hhbmdlRGVwdGguYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH0KCiAgICBvbkJlZm9yZVVubW91bnQoZnVuY3Rpb24gKCkgewogICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigicmVzaXplIiwgcmVzaXplKTsKICAgIH0pOwogICAgd2F0Y2goZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gW3NlbGVjdG9yU3RvcmUuY3VycmVudFNlcnZpY2UsIHNlbGVjdG9yU3RvcmUuY3VycmVudERlc3RTZXJ2aWNlXTsKICAgIH0sIGZ1bmN0aW9uICgpIHsKICAgICAgZnJlc2hOb2RlcygpOwogICAgfSk7CiAgICB3YXRjaChmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBhcHBTdG9yZS5kdXJhdGlvblRpbWU7CiAgICB9LCBmdW5jdGlvbiAoKSB7CiAgICAgIGlmIChkYXNoYm9hcmRTdG9yZS5lbnRpdHkgPT09IEVudGl0eVR5cGVbMV0udmFsdWUpIHsKICAgICAgICBmcmVzaE5vZGVzKCk7CiAgICAgIH0KICAgIH0pOwogICAgcmV0dXJuIGZ1bmN0aW9uIChfY3R4LCBfY2FjaGUpIHsKICAgICAgdmFyIF9jb21wb25lbnRfU2VsZWN0b3IgPSBfcmVzb2x2ZUNvbXBvbmVudCgiU2VsZWN0b3IiKTsKCiAgICAgIHZhciBfY29tcG9uZW50X0ljb24gPSBfcmVzb2x2ZUNvbXBvbmVudCgiSWNvbiIpOwoKICAgICAgdmFyIF9kaXJlY3RpdmVfbG9hZGluZyA9IF9yZXNvbHZlRGlyZWN0aXZlKCJsb2FkaW5nIik7CgogICAgICByZXR1cm4gX3dpdGhEaXJlY3RpdmVzKChfb3BlbkJsb2NrKCksIF9jcmVhdGVFbGVtZW50QmxvY2soImRpdiIsIHsKICAgICAgICByZWZfa2V5OiAiY2hhcnQiLAogICAgICAgIHJlZjogY2hhcnQsCiAgICAgICAgY2xhc3M6ICJtaWNyby10b3BvLWNoYXJ0IiwKICAgICAgICAiZWxlbWVudC1sb2FkaW5nLWJhY2tncm91bmQiOiAicmdiYSgwLCAwLCAwLCAwKSIsCiAgICAgICAgc3R5bGU6IF9ub3JtYWxpemVTdHlsZSgiaGVpZ2h0OiAiLmNvbmNhdChoZWlnaHQudmFsdWUsICJweCIpKQogICAgICB9LCBbX2NyZWF0ZUVsZW1lbnRWTm9kZSgiZGl2IiwgX2hvaXN0ZWRfMSwgW19jcmVhdGVFbGVtZW50Vk5vZGUoImRpdiIsIG51bGwsIFtfY3JlYXRlRWxlbWVudFZOb2RlKCJpbWciLCB7CiAgICAgICAgc3JjOiBfdW5yZWYoaWNvbnMpLkNVQkUKICAgICAgfSwgbnVsbCwgOCwgX2hvaXN0ZWRfMiksIF9jcmVhdGVFbGVtZW50Vk5vZGUoInNwYW4iLCBudWxsLCBfdG9EaXNwbGF5U3RyaW5nKHNldHRpbmdzLnZhbHVlLmRlc2NyaXB0aW9uID8gc2V0dGluZ3MudmFsdWUuZGVzY3JpcHRpb24uaGVhbHRoeSB8fCAiIiA6ICIiKSwgMSldKSwgX2NyZWF0ZUVsZW1lbnRWTm9kZSgiZGl2IiwgbnVsbCwgW19jcmVhdGVFbGVtZW50Vk5vZGUoImltZyIsIHsKICAgICAgICBzcmM6IF91bnJlZihpY29ucykuQ1VCRUVSUk9SCiAgICAgIH0sIG51bGwsIDgsIF9ob2lzdGVkXzMpLCBfY3JlYXRlRWxlbWVudFZOb2RlKCJzcGFuIiwgbnVsbCwgX3RvRGlzcGxheVN0cmluZyhzZXR0aW5ncy52YWx1ZS5kZXNjcmlwdGlvbiA/IHNldHRpbmdzLnZhbHVlLmRlc2NyaXB0aW9uLnVuaGVhbHRoeSB8fCAiIiA6ICIiKSwgMSldKV0pLCBzaG93U2V0dGluZy52YWx1ZSAmJiBfdW5yZWYoZGFzaGJvYXJkU3RvcmUpLmVkaXRNb2RlID8gKF9vcGVuQmxvY2soKSwgX2NyZWF0ZUVsZW1lbnRCbG9jaygiZGl2IiwgX2hvaXN0ZWRfNCwgW19jcmVhdGVWTm9kZShTZXR0aW5ncywgewogICAgICAgIG9uVXBkYXRlOiB1cGRhdGVTZXR0aW5ncywKICAgICAgICBvblVwZGF0ZU5vZGVzOiBmcmVzaE5vZGVzCiAgICAgIH0pXSkpIDogX2NyZWF0ZUNvbW1lbnRWTm9kZSgiIiwgdHJ1ZSksIF9jcmVhdGVFbGVtZW50Vk5vZGUoImRpdiIsIF9ob2lzdGVkXzUsIFtfd2l0aERpcmVjdGl2ZXMoX2NyZWF0ZUVsZW1lbnRWTm9kZSgic3BhbiIsIG51bGwsIFtfY3JlYXRlRWxlbWVudFZOb2RlKCJzcGFuIiwgX2hvaXN0ZWRfNiwgX3RvRGlzcGxheVN0cmluZyhfdW5yZWYodCkoImN1cnJlbnREZXB0aCIpKSwgMSksIF9jcmVhdGVWTm9kZShfY29tcG9uZW50X1NlbGVjdG9yLCB7CiAgICAgICAgY2xhc3M6ICJpbnB1dHMiLAogICAgICAgIHZhbHVlOiBkZXB0aC52YWx1ZSwKICAgICAgICBvcHRpb25zOiBfdW5yZWYoRGVwdGhMaXN0KSwKICAgICAgICBvbkNoYW5nZTogY2hhbmdlRGVwdGgKICAgICAgfSwgbnVsbCwgOCwgWyJ2YWx1ZSIsICJvcHRpb25zIl0pXSwgNTEyKSwgW1tfdlNob3csIF91bnJlZihncmFwaENvbmZpZykuc2hvd0RlcHRoXV0pLCBfdW5yZWYoZGFzaGJvYXJkU3RvcmUpLmVkaXRNb2RlID8gKF9vcGVuQmxvY2soKSwgX2NyZWF0ZUVsZW1lbnRCbG9jaygic3BhbiIsIHsKICAgICAgICBrZXk6IDAsCiAgICAgICAgY2xhc3M6ICJzd2l0Y2gtaWNvbiBtbC01IiwKICAgICAgICB0aXRsZTogIlNldHRpbmdzIiwKICAgICAgICBvbkNsaWNrOiBzZXRDb25maWcKICAgICAgfSwgW19jcmVhdGVWTm9kZShfY29tcG9uZW50X0ljb24sIHsKICAgICAgICBzaXplOiAibWlkZGxlIiwKICAgICAgICBpY29uTmFtZTogInNldHRpbmdzIgogICAgICB9KV0pKSA6IF9jcmVhdGVDb21tZW50Vk5vZGUoIiIsIHRydWUpLCBfY3JlYXRlRWxlbWVudFZOb2RlKCJzcGFuIiwgewogICAgICAgIGNsYXNzOiAic3dpdGNoLWljb24gbWwtNSIsCiAgICAgICAgdGl0bGU6ICJCYWNrIHRvIG92ZXJ2aWV3IHRvcG9sb2d5IiwKICAgICAgICBvbkNsaWNrOiBiYWNrVG9Ub3BvbG9neQogICAgICB9LCBbX2NyZWF0ZVZOb2RlKF9jb21wb25lbnRfSWNvbiwgewogICAgICAgIHNpemU6ICJtaWRkbGUiLAogICAgICAgIGljb25OYW1lOiAia2V5Ym9hcmRfYmFja3NwYWNlIgogICAgICB9KV0pXSksIF91bnJlZih0b3BvbG9neVN0b3JlKS5ub2RlID8gKF9vcGVuQmxvY2soKSwgX2NyZWF0ZUVsZW1lbnRCbG9jaygiZGl2IiwgewogICAgICAgIGtleTogMSwKICAgICAgICBjbGFzczogIm9wZXJhdGlvbnMtbGlzdCIsCiAgICAgICAgc3R5bGU6IF9ub3JtYWxpemVTdHlsZSh7CiAgICAgICAgICB0b3A6IF91bnJlZihvcGVyYXRpb25zUG9zKS55ICsgJ3B4JywKICAgICAgICAgIGxlZnQ6IF91bnJlZihvcGVyYXRpb25zUG9zKS54ICsgJ3B4JwogICAgICAgIH0pCiAgICAgIH0sIFsoX29wZW5CbG9jayh0cnVlKSwgX2NyZWF0ZUVsZW1lbnRCbG9jayhfRnJhZ21lbnQsIG51bGwsIF9yZW5kZXJMaXN0KGl0ZW1zLnZhbHVlLCBmdW5jdGlvbiAoaXRlbSwgaW5kZXgpIHsKICAgICAgICByZXR1cm4gX29wZW5CbG9jaygpLCBfY3JlYXRlRWxlbWVudEJsb2NrKCJzcGFuIiwgewogICAgICAgICAga2V5OiBpbmRleCwKICAgICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soJGV2ZW50KSB7CiAgICAgICAgICAgIHJldHVybiBpdGVtLmZ1bmMoaXRlbS5kYXNoYm9hcmQpOwogICAgICAgICAgfQogICAgICAgIH0sIF90b0Rpc3BsYXlTdHJpbmcoaXRlbS50aXRsZSksIDksIF9ob2lzdGVkXzcpOwogICAgICB9KSwgMTI4KSldLCA0KSkgOiBfY3JlYXRlQ29tbWVudFZOb2RlKCIiLCB0cnVlKV0sIDQpKSwgW1tfZGlyZWN0aXZlX2xvYWRpbmcsIGxvYWRpbmcudmFsdWVdXSk7CiAgICB9OwogIH0KfSk7"},null]}